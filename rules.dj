begin rule "accessions"

    output.patent.identifiers := list_new()
    
    if input.patent.accessions then
        accessions := input.patent.accessions as list 
        
        for item in accessions loop 
          obj := {}
          obj.updatedBy := ""
          obj.wipFlag := false
          obj.confidence := 100
          obj.rank := 1
          obj.action := ""
          obj.value := item.accession
          obj.scheme := item.@tsip:type
          obj.sourceName := item.@tsip:src 
        		
        		
        	obj.sourcePGUID := "urn:source:000000000000000000000000000022"
      		if (item.@tsip:src = "wila") then 
            obj.sourcePGUID := "urn:source:000000000000000000000000000021"
          end if 

          list_add(output.patent.identifiers, obj)
        
        end loop 
    end if

end rule
begin rule "namespace"

    output.patent.factValues := list_new()
    output.patent.relationships := list_new()

end rule
begin rule "abstracts"

    ######### START FACT: ABSTRACTS ############################
    if input.patent.abstracts then 
        abstracts := input.patent.abstracts as list
        
        array_index := 1 
        for item in abstracts loop 
            
            if (item._internal_ = "abstract") then 
              fact_obj := fact_get("abstracts.abstract.text", item.abstract ,"7","692","717","standard","abstracts.abstract",[1, 1, array_index])
              fact_obj.charset := none
              fact_obj.language := item.@tsip:lang
              fact_obj.input := "original"
            
            else if (item._internal_ = "abstractTsxm") then 
              fact_obj := fact_get("abstracts.abstract.text",item.abstractTsxm as string,"7","692","717","tsxm","abstracts.abstract",[1, 1, array_index])
              fact_obj.charset := none
              fact_obj.language := item.@tsip:lang 
              fact_obj.input := "original"
              list_add(output.patent.factValues, fact_obj)
            
            end if 
            
            array_index := array_index + 1
        end loop 

        
        abstracts_self := list_self(abstracts)
        fact_obj := fact_get("abstracts.content",abstracts_self.xml,"7","691","727","","abstracts",[1, 1])
        fact_obj.language := none
        fact_obj.input := "original"
        list_add(output.patent.factValues, fact_obj)
    end if 
    ######### END FACT: ABSTRACTS ############################
  

end rule
begin rule "literatureCitations"

    ######### START LOGICAL UNIT: LITERATURECITATIONS ############################
    if input.patent.literatureCitations then 
        literatureCitations := input.patent.literatureCitations as list 
        literatureCitations_self := list_self(literatureCitations)
        
        
        list_add(output.patent.factValues, fact_get("literatureCitations.content",literatureCitations_self.xml ,"7","85","86",none,"literatureCitations", [1, 1]))
    end if 
    ######### END LOGICAL UNIT: LITERATURECITATIONS ############################

end rule
begin rule "miscellaneous"

    ######### START FACT: MISCELLANEOUS ############################)
    if input.patent.miscellaneous then 
        items := input.patent.miscellaneous as list 
        
        xml_string := "<miscellaneous>"
        
        for item in items loop 
          xml_string := concat([xml_string, item.xml])
        end loop 

        xml_string := concat([xml_string, "</miscellaneous>"])
        
        list_add(output.patent.factValues, fact_get("miscellaneous.content",xml_string,"7","81","82",none,"miscellaneous",[1, 1]))
    end if 
    ######### END FACT: MISCELLANEOUS ############################
    
end rule
begin rule "imagerefs"

    ######### START FACT: IMAGEREFS ############################
    if input.patent.imageRefs then 
        imageRefs := input.patent.imageRefs as list 
        imageRefs_self := list_self(imageRefs)
        fact_obj := fact_get("Imagerefs.content", imageRefs_self.xml,"7","27","28",none,"imageRefs",[1, 1])
        fact_obj.input := none
        fact_obj.language := none
        list_add(output.patent.factValues, fact_obj)
    end if 
    ######### END FACT: IMAGEREFS ############################
    

end rule
begin rule "updates"

    ######### START FACT: UPDATES ############################
    if input.patent.updates then 
        updates := input.patent.updates as list 
        updates_self := list_self(updates)

        array_index := 1 
        for item in updates loop
            list_add(output.patent.factValues, fact_get("updates.update.content", item.update, "7","88","251",none,"updates.update", [1, 1, array_index]))

            if item.@tsip:src then 
                list_add(output.patent.factValues, fact_get("updates.update.source",item.@tsip:src,"7","88","89",none,"updates.update",[1, 1, array_index]))
            end if 
            
            if item.@tsip:type then 
                list_add(output.patent.factValues, fact_get("updates.update.type",item.@tsip:type,"7","88","90",none,"updates.update",[1, 1, array_index]))
            end if 

            array_index := array_index + 1
        end loop 


        list_add(output.patent.factValues, fact_get("updates.content",updates_self.xml,"7","87","91",none,"updates",[1, 1]))
    end if 
    ######### END FACT: UPDATES ############################

end rule
begin rule "applications"

    ######### START FACT: APPLICATIONS ############################
    if input.patent.applications then 
        applications := input.patent.applications as list 
        applications_self := list_self(applications)
        
        array_index := 1 
        for item in applications loop 
        
            if item.@tsip:cc then 
                list_add(output.patent.factValues,fact_get("applications.application.patentCountry",item.@tsip:cc,"7","93","94",none,"applications.application",[1, 1, array_index]))
            end if 
        
            if item.isRep then 
                list_add(output.patent.factValues,fact_get("applications.application.isRep",item.isRep,"7","93","99",none,"applications.application",[1, 1, array_index]))
            end if 
            
        
            if item.@tsip:ki then 
                list_add(output.patent.factValues,fact_get("applications.application.patentKind",item.@tsip:ki,"7","93","95",none,"applications.application",[1, 1, array_index]))
            end if 
            
        
            if item.linkageType then 
                list_add(output.patent.factValues,fact_get("applications.application.linkageType",item.linkageType,"7","93","100",none,"applications.application",[1, 1, array_index]))
            end if 
            
        
            if item.otherSe then 
                list_add(output.patent.factValues,fact_get("applications.application.otherSerial",item.otherSe,"7","93","101",none,"applications.application",[1, 1, array_index]))
            end if 
            
        
            if item.@tsip:priorityCode then 
                list_add(output.patent.factValues,fact_get("applications.application.priorityCode",item.@tsip:priorityCode,"7","93","96",none,"applications.application",[1, 1, array_index]))
            end if 
            
        
            if item.@tsip:relationCode then 
                list_add(output.patent.factValues,fact_get("applications.application.wilaRelationCode",item.@tsip:relationCode,"7","93","98",none,"applications.application",[1, 1, array_index]))
            end if 
            
        
            if item.@tsip:se then 
                list_add(output.patent.factValues,fact_get("applications.application.serial",item.@tsip:se,"7","93","97",none,"applications.application",[1, 1, array_index]))
            end if 

            if item.textDescription then 
                list_add(output.patent.factValues,fact_get("applications.application.textDescription",item.textDescription,"7","93","116",none,"applications.application",[1, 1, array_index]))
            end if 
            
            if item.@tsip:lang then 
                    list_add(output.patent.factValues,fact_get("applications.application.applang",item.@tsip:lang,"7","93","830",none,"applications.application",[1, 1, array_index]))
            end if 
            
            
            app_id_items := item.applicationId as list 
            
            for app_id_item in app_id_items loop 
                if app_id_item._internal_ = "appId" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.appId",app_id_item.appId,"7","102","104",none,"applications.application.applicationId",[1, 1, array_index, 1]))
                end if 
                
            
                if app_id_item._internal_ = "applicationYear" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.applicationYear",app_id_item.applicationYear,"7","102","106",none,"applications.application.applicationId",[1, 1, array_index, 1]))
                end if 
                
            
                if app_id_item._internal_ = "countryCode" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.countryCode",app_id_item.countryCode,"7","102","107",none,"applications.application.applicationId",[1, 1, array_index, 1]))
                end if 
                
            
                if app_id_item._internal_ = "date" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.date", app_id_item.date,"7","102","111",none,"applications.application.applicationId",[1, 1, array_index, 1]))
                end if 
                
            
                if app_id_item._internal_ = "error" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.appIdError",app_id_item.error,"7","102","103",none,"applications.application.applicationId",[1, 1, array_index, 1]))
                end if 
                
            
                if app_id_item._internal_ = "kindCode" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.kindCode.src",app_id_item.kindCode.@tsip:src,"7","108","110",none,"applications.application.applicationId.kindCode",[1, 1, array_index, 1, 1]))
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.kindCode.text",app_id_item.kindCode,"7","108","109",none,"applications.application.applicationId.kindCode",[1, 1, array_index, 1]))
                end if 
                
            
                if app_id_item._internal_ = "number" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.number.form",app_id_item.number.@tsip:form,"7","112","114",none,"applications.application.applicationId.number",[1, 1, array_index, 1, 1]))
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.number.text",app_id_item.number,"7","112","113",none,"applications.application.applicationId.number",[1, 1, array_index, 1]))
                end if 
                
                if app_id_item._internal_ = "permId" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.permId",app_id_item.permId,"7","102","105",none,"applications.application.applicationId",[1, 1, array_index, 1]))
                end if 
                
                if app_id_item._internal_ = "seriesCode" then 
                    list_add(output.patent.factValues,fact_get("applications.application.applicationId.seriesCode",app_id_item.seriesCode,"7","102","115",none,"applications.application.applicationId",[1, 1, array_index, 1]))
                end if
            end loop 
            
            array_index := array_index + 1
        end loop 

        list_add(output.patent.factValues,fact_get("applications.content",applications_self.xml,"7","92","117",none,"applications",[1, 1]))
    end if 
    ######### END FACT: APPLICATIONS ############################



end rule
begin rule "relateds"

    ######### START FACT: RELATEDS ############################
    if input.patent.relateds then 
        relateds := input.patent.relateds
        items := relateds as list 
        relateds_self := list_self(items)
        
        array_index := 1 
        for item in items loop 
            #if item._internal_ = "related" then 
                if item.isRep then 
                    fact_obj := fact_get("relateds.related.disRep",item.isRep,"7","134","138",none,"relateds.related",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.linkageType then 
                    fact_obj := fact_get("relateds.related.linkageType",item.linkageType,"7","134","139",none,"relateds.related",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.parentStatus then 
                    fact_obj := fact_get("relateds.related.parentStatus",item.parentStatus,"7","134","135",none,"relateds.related",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.@tsip:priorityCode then 
                    fact_obj := fact_get("relateds.related.priorityCode",item.@tsip:priorityCode,"7","134","136",none,"relateds.related",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.@wila:relationCode then 
                    fact_obj := fact_get("relateds.related.wilarelationCode",item.@wila:relationCode,"7","134","137",none,"relateds.related",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.textDescription then 
                    fact_obj := fact_get("relateds.related.contentDescription",item.textDescription,"7","134","152",none,"relateds.related",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
                
                if item.documentId then 
                    document_id_items := item.documentId as list 
                    
                    for document_id_item in document_id_items loop 
                        if document_id_item._internal_ = "countryCode" then 
                            fact_obj := fact_get("relateds.related.document.countryCode",document_id_item.countryCode,"7","153","159",none,"relateds.related.document",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if document_id_item._internal_ = "date" then 
                            fact_obj := fact_get("relateds.related.document.date",document_id_item.date,"7","153","162",none,"relateds.related.document",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if document_id_item._internal_ = "error" then 
                            fact_obj := fact_get("relateds.related.document.error",document_id_item.error,"7","153","154",none,"relateds.related.document",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                        
                        if document_id_item.kindCode.@tsip:src then 
                            fact_obj := fact_get("relateds.related.document.kindCode.Source",document_id_item.kindCode.@tsip:src,"7","160","161",none,"relateds.related.document.kindCode",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                        if document_id_item._internal_ = "kindCode" then 
                            fact_obj := fact_get("relateds.related.document.kindCode.content",document_id_item.kindCode,"7","160","255",none,"relateds.related.document.kindCode",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if document_id_item._internal_ = "number" then 
                            fact_obj := fact_get("relateds.related.document.number.Form",document_id_item.number.@tsip:form,"7","157","158",none,"relateds.related.document.number",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                    
                            fact_obj := fact_get("relateds.related.document.number.content",document_id_item.number,"7","157","254",none,"relateds.related.document.number",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if document_id_item._internal_ = "permId" then 
                            fact_obj := fact_get("relateds.related.document.permId",document_id_item.permId,"7","153","156",none,"relateds.related.document",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if document_id_item._internal_ = "pubId" then 
                            fact_obj := fact_get("relateds.related.document.pubId",document_id_item.pubId,"7","153","155",none,"relateds.related.document",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    end loop 
                end if 
                
                if item.applicationId then 
                    application_id_items := item.applicationId as list 
                    
                    for application_id_item in application_id_items loop 
                    
                        if application_id_item._internal_ = "appId" then 
                            fact_obj := fact_get("relateds.related.application.appID",application_id_item.appId,"7","140","142",none,"relateds.related.application",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "applicationYear" then 
                            fact_obj := fact_get("relateds.related.application.applicationYear",application_id_item.applicationYear,"7","140","144",none,"relateds.related.application",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "countryCode" then 
                            fact_obj := fact_get("relateds.related.application.countryCode",application_id_item.countryCode,"7","140","145",none,"relateds.related.application",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "date" then 
                            fact_obj := fact_get("relateds.related.application.date",application_id_item.date,"7","140","146",none,"relateds.related.application",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "error" then 
                            fact_obj := fact_get("relateds.related.application.error",application_id_item.error,"7","140","141",none,"relateds.related.application",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item.kindCode.@tsip:src then 
                            fact_obj := fact_get("relateds.related.application.kindCode.Source",application_id_item.kindCode.@tsip:src,"7","149","150",none,"relateds.related.application.kindCode",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "kindCode" then 
                            fact_obj := fact_get("relateds.related.application.kindCode.content",application_id_item.kindCode,"7","149","253",none,"relateds.related.application.kindCode",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "number" then 
                            fact_obj := fact_get("relateds.related.application.number.Form",application_id_item.number.@tsip:form,"7","147","148",none,"relateds.related.application.number",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                      
                            fact_obj := fact_get("relateds.related.application.number.content",application_id_item.number,"7","147","252",none,"relateds.related.application.number",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "permId" then 
                            fact_obj := fact_get("relateds.related.application.permId",application_id_item.permId,"7","140","143",none,"relateds.related.application",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                    
                        if application_id_item._internal_ = "seriesCode" then 
                            fact_obj := fact_get("relateds.related.application.seriesCode",application_id_item.seriesCode,"7","140","151",none,"relateds.related.application",[1,1,array_index, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                    end loop 
                end if 
            
            
            if item._internal = "relatedAscontent" then 
                if item.@tsip:cc then 
                    fact_obj := fact_get("relateds.relatedAscontent.countryCode",item.@tsip:cc,"7","214","216",none,"relateds.relatedAscontent",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.@tsip:ki then 
                    fact_obj := fact_get("relateds.relatedAscontent.kindCode",item.@tsip:ki,"7","214","218",none,"relateds.relatedAscontent",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.refId then 
                    fact_obj := fact_get("relateds.relatedAscontent.refId",item.refId,"7","214","215",none,"relateds.relatedAscontent",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.@tsip:se then 
                    fact_obj := fact_get("relateds.relatedAscontent.seriesCode",item.@tsip:se,"7","214","217",none,"relateds.relatedAscontent",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
            end if 
            
            if item._internal_ = "relatedParentChild" then 
            
                        
                if item.parent.parentStatus then 
                    fact_obj := fact_get("relateds.relatedParentChild.parent.parentStatus",item.parent.parentStatus,"7","189","190",none,"relateds.relatedParentChild.parent",[1,1,array_index, 1])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
                
                if item.@tsip:priorityCode then 
                    fact_obj := fact_get("relateds.relatedParentChild.priorityCode",item.@tsip:priorityCode,"7","163","164",none,"relateds.relatedParentChild",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.@wila:relationCode then 
                    fact_obj := fact_get("relateds.relatedParentChild.wilarelationCode",item.@wila:relationCode,"7","163","165",none,"relateds.relatedParentChild",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
            
                if item.textDescription then 
                    fact_obj := fact_get("relateds.relatedParentChild.contentDescription",item.textDescription,"7","163","213",none,"relateds.relatedParentChild",[1,1,array_index])
                    list_add(output.patent.factValues,fact_obj)
                end if 
                
                
                if item.child.applicationId then 
                    items_child_applicationId := item.child.applicationId as list 
                    
                    for item_child_applicationId in items_child_applicationId loop 

                
                        if item_child_applicationId._internal_ = "appId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.appid",item_child_applicationId.appId,"7","167","169",none,"relateds.relatedParentChild.child.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "applicationYear" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.applicationYear",item_child_applicationId.applicationYear,"7","167","171",none,"relateds.relatedParentChild.child.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "countryCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.countryCode",item_child_applicationId.countryCode,"7","167","172",none,"relateds.relatedParentChild.child.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "date" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.date",item_child_applicationId.date,"7","167","173",none,"relateds.relatedParentChild.child.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "error" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.error",item_child_applicationId.error,"7","167","168",none,"relateds.relatedParentChild.child.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId.kindCode@tsip:src then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.kindCode.source",item_child_applicationId.kindCode.@tsip:src,"7","176","177",none,"relateds.relatedParentChild.child.application.kindCode",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "kindCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.kindCode.content",item_child_applicationId.kindCode,"7","176","257",none,"relateds.relatedParentChild.child.application.kindCode",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId.number@tsip:form then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.number.Form",item_child_applicationId.number.@tsip:form,"7","174","175",none,"relateds.relatedParentChild.child.application.number",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "number" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.number.content",item_child_applicationId.number,"7","174","256",none,"relateds.relatedParentChild.child.application.number",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "permId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.permid",item_child_applicationId.permId,"7","167","170",none,"relateds.relatedParentChild.child.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_applicationId._internal_ = "seriesCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.application.seriesCode",item_child_applicationId.seriesCode,"7","167","178",none,"relateds.relatedParentChild.child.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        

                    end loop 
                end if 
                
                if item.child.documentId then 
                    items_child_documentId := item.child.documentId as list 
                    
                    for item_child_documentId in items_child_documentId loop 
                
                        if item_child_documentId._internal_ = "countryCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.countryCode",item_child_documentId.countryCode,"7","179","185",none,"relateds.relatedParentChild.child.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId._internal_ = "date" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.date",item_child_documentId.date,"7","179","188",none,"relateds.relatedParentChild.child.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId._internal_ = "error" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.error",item_child_documentId.error,"7","179","180",none,"relateds.relatedParentChild.child.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId.kindCode@tsip:src then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.kindCode.source",item_child_documentId.kindCode.@tsip:src,"7","186","187",none,"relateds.relatedParentChild.child.document.kindCode",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId._internal_ = "kindCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.kindCode.content",item_child_documentId.kindCode,"7","186","259",none,"relateds.relatedParentChild.child.document.kindCode",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId.number@tsip:form then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.number.Form",item_child_documentId.number.@tsip:form,"7","183","184",none,"relateds.relatedParentChild.child.document.number",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId._internal_ = "number" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.number.content",item_child_documentId.number,"7","183","258",none,"relateds.relatedParentChild.child.document.number",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId._internal_ = "permId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.permId",item_child_documentId.permId,"7","179","182",none,"relateds.relatedParentChild.child.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_child_documentId._internal_ = "pubId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.child.document.pubId",item_child_documentId.pubId,"7","179","181",none,"relateds.relatedParentChild.child.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                    end loop 
                end if 
                
                
                if item.parent.applicationId then 
                    items_parent_applicationId := item.parent.applicationId as list 
                    
                    for item_parent_applicationId in items_parent_applicationId loop 
                        if item_parent_applicationId._internal_ = "appId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.docdbAppId",item_parent_applicationId.appId,"7","191","193",none,"relateds.relatedParentChild.parent.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId._internal_ = "applicationYear" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.applicationYear",item_parent_applicationId.applicationYear,"7","191","195",none,"relateds.relatedParentChild.parent.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId._internal_ = "countryCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.countryCode",item_parent_applicationId.countryCode,"7","191","196",none,"relateds.relatedParentChild.parent.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId._internal_ = "date" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.date",item_parent_applicationId.date,"7","191","197",none,"relateds.relatedParentChild.parent.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId._internal_ = "error" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.error",item_parent_applicationId.error,"7","191","192",none,"relateds.relatedParentChild.parent.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId.kindCode@tsip:src then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.kindCode.source",item_parent_applicationId.kindCode.@tsip:src,"7","200","201",none,"relateds.relatedParentChild.parent.application.kindCode",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId._internal_ = "kindCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.kindCode.content",item_parent_applicationId.kindCode,"7","200","261",none,"relateds.relatedParentChild.parent.application.kindCode",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId.number@tsip:form then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.number.Form",item_parent_applicationId.number.@tsip:form,"7","198","199",none,"relateds.relatedParentChild.parent.application.number",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId._internal_ = "number" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.number.content",item_parent_applicationId.number,"7","198","260",none,"relateds.relatedParentChild.parent.application.number",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_applicationId._internal_ = "permId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.application.permId",item_parent_applicationId.permId,"7","191","194",none,"relateds.relatedParentChild.parent.application",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                    end loop 
                end if 
                
                
                if item.parent.documentId then 
                    items_parent_documentId := item.parent.documentId as list 
                    
                    for item_parent_documentId in items_parent_documentId loop 

                        if item_parent_documentId._internal_ = "countryCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.countryCode",item_parent_documentId.countryCode,"7","203","209",none,"relateds.relatedParentChild.parent.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId._internal_ = "date" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.date",item_parent_documentId.date,"7","203","212",none,"relateds.relatedParentChild.parent.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId._internal_ = "error" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.error",item_parent_documentId.error,"7","203","204",none,"relateds.relatedParentChild.parent.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId.kindCode@tsip:src then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.kindCode.source",item_parent_documentId.kindCode.@tsip:src,"7","210","211",none,"relateds.relatedParentChild.parent.document.kindCode",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId._internal_ = "kindCode" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.kindCode.content",item_parent_documentId.kindCode,"7","210","263",none,"relateds.relatedParentChild.parent.document.kindCode",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId.number@tsip:form then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.number.Form",item_parent_documentId.number.@tsip:form,"7","207","208",none,"relateds.relatedParentChild.parent.document.number",[1, 1, array_index, 1, 1,1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId._internal_ = "number" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.number.content",item_parent_documentId.number,"7","207","262",none,"relateds.relatedParentChild.parent.document.number",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId._internal_ = "permId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.permId",item_parent_documentId.permId,"7","203","206",none,"relateds.relatedParentChild.parent.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                        
                
                        if item_parent_documentId._internal_ = "pubId" then 
                            fact_obj := fact_get("relateds.relatedParentChild.parent.document.pubId",item_parent_documentId.pubId,"7","203","205",none,"relateds.relatedParentChild.parent.document",[1, 1, array_index, 1, 1])
                            list_add(output.patent.factValues,fact_obj)
                        end if 
                    end loop 
                end if 
            end if 
        
            array_index := array_index + 1
        end loop 

        list_add(output.patent.factValues,fact_get("relateds.content",relateds_self.xml,"7","133","219",none,"relateds",[1, 1]))
    end if 
    ######### END FACT: RELATEDS ############################


end rule
begin rule "publications"

  ######### START LOGICAL UNIT: PUBLICATIONS ############################
    if input.patent.publications then 
        publications := input.patent.publications as list
        publications_self := list_self(publications)
        
        array_index := 1
        for pub in publications loop
          
          # publication attributes
          if pub.@tsip:drawings then
            list_add(output.patent.factValues, fact_get("publications.publication.drawings", pub.@tsip:drawings, "7","35","36",none,"publications.publication",[1,1,array_index]))
          end if 
          
          # drawingPages
          if pub.@tsip:drawingPages then 
            list_add(output.patent.factValues, fact_get("publications.publication.drawingPages", pub.@tsip:drawingPages, "7","35","42",none,"publications.publication",[1,1,array_index]))
          end if 
          
          # lang
          if pub.@tsip:lang then 
            list_add(output.patent.factValues, fact_get("publications.publication.language", pub.@tsip:lang , "7","35","718",none,"publications.publication",[1,1,array_index]))
          end if 
          
          # get publication child elements as list
        	pub_elements := pub.publication as list 
        	
        	# loop through publication child elements
        	for pub_element in pub_elements loop
        	
        	 # documentId
           if pub_element._internal_ = "documentId" then 
        			doc_elements := pub.documentId as list  
        			
        			
        			
        			# loop through documentId child elements
        			for doc_element in doc_elements loop

        				# number
        				array_index2 := 1 
        				if doc_element._internal_ = "number" then 
        				
                    list_add(output.patent.factValues, fact_get("publications.publication.document.number.form",doc_element.@tsip:form,"7","54","55",none,"publications.publication.document.number",[1,1,array_index,1,array_index2]))
                    list_add(output.patent.factValues, fact_get("publications.publication.document.number.content",doc_element.number,"7","54","250",none,"publications.publication.document.number",[1,1,array_index,1, array_index2]))
                    
                    array_index2 := array_index2 + 1 
                    if(doc_element.@tsip:form = "tsip") then
                      tsipNbr := doc_element.number
                    end if
                end if
        				
                # countryCode
        				if doc_element._internal_ = "countryCode" then 
                    list_add(output.patent.factValues, fact_get("publications.publication.document.countryCode",doc_element.countryCode,"7","46","50",none,"publications.publication.document",[1,1,array_index,1]))            
        				    cntry := doc_element.countryCode
        				end if 
        				
        				# kindCode
        				if doc_element._internal_ = "kindCode" then 
                  list_add(output.patent.factValues, fact_get("publications.publication.document.kindCode.content",doc_element.kindCode,"7","52","249",none,"publications.publication.document.kindCode",[1,1,array_index,1,1]))            
        				  kc := doc_element.kindCode
        				end if 
        				
        				# date
        				if doc_element._internal_ = "date" then 
                  list_add(output.patent.factValues, fact_get("publications.publication.document.date",doc_element.date,"7","46","51",none,"publications.publication.document",[1,1,array_index,1]))            
                  dt := doc_element.date
                end if
        				
        			end loop

        			output.patent._outputfilename_ := concat([cntry,tsipNbr,kc,"_",dt])
        			
        		end if 
        		
        		# kindText
        		if pub_element._internal_ = "kindText" then 
        		end if 
        
        		# publicationFirst
        		if pub_element._internal_ = "publicationFirst" then 
              list_add(output.patent.factValues, fact_get("publications.publication.publicationFirst.date",pub_element.publicationFirst.date,"7","57","58",none,"publications.publication.publicationFirst",[1,1,array_index,1]))
            end if   
        		
        		# searchReport
        		if pub_element._internal_ = "searchReport" then 
        		end if 
        		
        		# patentDate
        		if pub_element._internal_ = "patentDate" then 
                list_add(output.patent.factValues, fact_get("publications.publication.patentDate.date",pub_element.patentDate.date,"7","61","62",none,"publications.publication.patentDate",[1,1,array_index,1]))
                if pub_element.patentDate.@tsip:no then
                    list_add(output.patent.factValues, fact_get("publications.publication.patentDate.no",pub_element.patentDate.@tsip:no,"7","61","63",none,"publications.publication.patentDate",[1,1,array_index,1]))
                end if
        		end if 
            
            # classificationIpc
        		if pub_element._internal_ = "classificationIpc" then 
        		  if pub_element.@tsip:action then 
                list_add(output.patent.factValues, fact_get("publications.publication.classificationIpc.action",pub_element.@tsip:action,"7","43","44",none,"publications.publication.classificationIpc",[1,1,array_index,1]))
              end if 
              classificationIpc_list := pub_element.classificationIpc as list 
              for ipc_element in classificationIpc_list loop 
                if ipc_element._internal_ = "ipc" then 
                    list_add(output.patent.factValues, fact_get("publications.publication.classificationIpc.ipc",ipc_element.ipc,"7","43","45",none,"publications.publication.classificationIpc",[1,1,array_index,1,1]))
                end if
              end loop 
        		end if 
        
        		# designatedStates
        		if pub_element._internal_ = "designatedStates" then 
        			desigStates_elements := pub_element.route as list 
        
        			for desigState_element in desigStates_elements loop
        				countryCodes_elements := desigState_element.countryCode as list
        
        				for countryCodes_element in countryCodes_elements loop
        					
        				end loop
        				
        			end loop
        		end if 
        		
        		if pub_element._internal_ = "languages" then 
        		end if 
        
        end loop

        array_index := array_index + 1
      end loop   
        
      list_add(output.patent.factValues,fact_get("publications.content",publications_self.xml ,"7","34","74",none,"publications",[1, 1]))

    end if 
	######### END LOGICAL UNIT: PUBLICATIONS ############################


end rule
begin rule "titles"

  ######### START FACT: TITLES ############################
  if input.patent.titles then 

  	titles := input.patent.titles
  	items := titles as list 
  	
  	titles_self := list_self(items)
  
  	array_index := 1 
  	for item in items loop 
  		if item.title then 
  			if isList(item.title) then 
          item_title := concat(item.title)
        else 
          item_title := item.title
        end if 

  			fact_obj := fact_get("titles.title",item_title,"7","29","30","standard","titles",[1,1])
    		fact_obj.language := item.@language
    		fact_obj.input := item.@input
  			list_add(output.patent.factValues,fact_obj)
  		end if 
  
  
  		if item.titleTsxm then 
  			if isList(item.titleTsxm) then 
          item_titleTsxm := concat(item.titleTsxm)
        else 
          item_titleTsxm := item.titleTsxm
        end if 
        
    			fact_obj := fact_get("titles.title", item_titleTsxm,"7","29","30","tsxm","titles",[1,1])
    			fact_obj.language := item.@language
    			fact_obj.input := item.@input
    			list_add(output.patent.factValues,fact_obj)
  		end if       
  
  		array_index := array_index + 1
  	end loop 
  
  	fact_obj := fact_get("titles.content",titles_self.xml,"7","29","31","","titles",[1,1])
  	fact_obj.language := none
  	fact_obj.input := none
  	list_add(output.patent.factValues,fact_obj)
  end if 
  ######### END FACT: TITLES ############################



end rule
begin rule "amendments"

    ######### START FACT: AMENDMENTS ############################
    if input.patent.amendments then 
        amendments := input.patent.amendments as list 
        amendments_self := list_self(amendments)
        list_add(output.patent.factValues,fact_get("amendments.content",amendments_self.xml,"7","11","12","","amendments",[1, 1]))
    end if 
    ######### END FACT: AMENDMENTS ############################


end rule
begin rule "descriptionsOriginal"

    ######### START FACT: DESCRIPTIONSORIGINAL ############################
    if input.patent.descriptionsOriginal then 
        descriptionsOriginal := input.patent.descriptionsOriginal as list 
        descriptionsOriginal_self := list_self(descriptionsOriginal)
        list_add(output.patent.factValues,fact_get("descriptionsOriginal.content",descriptionsOriginal_self.xml,"7","75","76","","descriptionsOriginal",[1, 1]))
    end if 
    ######### END FACT: DESCRIPTIONSORIGINAL ############################

end rule
begin rule "claimed"


  ######### START FACT: CLAIMED ############################
    if input.patent.claimed then 
        claimed := input.patent.claimed as list 
        claimed_self := list_self(claimed)

        array_index := 1 
        
        for item in claimed loop
          if (item._internal_ = "claimsTsxm") then 
            claimsTsxm_as_list := item.claimsTsxm as list 
            claimsTsxm_self := list_self(claimsTsxm_as_list)
            
            fact_obj := fact_get("claimed.claims",claimsTsxm_self.xml,"7","32","33","tsxm","claimed",[1,1,array_index])
            fact_obj.language := "en"
            fact_obj.input := none
            list_add(output.patent.factValues,fact_obj)
          end if 

          
          if item._internal_ = "claims" then 
            claims_as_list := item.claims as list 
            claims_self := list_self(claims_as_list)
            fact_obj := fact_get("claimed.claims",claims_self.xml,"7","32","33","standard","claimed",[1,1,array_index])
            fact_obj.language := "en"
            fact_obj.input := none
            list_add(output.patent.factValues,fact_obj)
          end if 
          
            array_index := array_index + 1
        end loop 

        
        fact_obj := fact_get("claimed.content",claimed_self.xml,"7","32","711","","claimed",[1,1])
        fact_obj.language := none
        fact_obj.input := none
        list_add(output.patent.factValues,fact_obj)     
    end if 
    ######### END FACT: CLAIMED ############################


end rule
begin rule "corrections"

    ######### START FACT: CORRECTIONS ############################
    if input.patent.corrections then 
        corrections := input.patent.corrections as list 
        corrections_self := list_self(corrections)
        fact_obj := fact_get("corrections.content",corrections_self.xml,"7","21","22","","corrections",[1,1])
        fact_obj.language := none
        fact_obj.input := none
        list_add(output.patent.factValues,fact_obj)
    end if 
    ######### END FACT: CORRECTIONS ############################
end rule
begin rule "assignees"

  ######### START FACT: ASSIGNEES ############################
  if input.patent.assignees then 
  assignees := input.patent.assignees as list 
  array_index := 1 
  for item in assignees loop 
    if (item._internal_ = "update") then 
      
    else if (item._internal_ = "assignee") then
  		relationship_node := {}
  		relationship_node.relatedToIdScheme := ""
  		relationship_node.updatedBy := ""
  		relationship_node.confidence := 100
  		relationship_node.queued := ""
  		relationship_node.parentArrayIndex := [1, 1]
  		relationship_node.predicate := "assignee_of"
  		relationship_node.sourcePGUID := "urn:source:000000000000000000000000000007"
  		relationship_node.groupPGUID := "urn:fact:patent:000000000000000000000000000303"
  		relationship_node.wipFlag := false
  		relationship_node.relatedToId := ""
  		relationship_node.factPGUID := "urn:fact:patent:000000000000000000000000000304"
  		relationship_node.action := "add"
  		relationship_node.arrayIndex := array_index 
  		facts := list_new()

      assignee_as_list := item.assignee as list 
      assignee_self := list_self(assignee_as_list)
      
      if assignee_self.@tsip:appType then 
        fact_obj := fact_get("assignees.assignee.appType",assignee_self.@tsip:appType,"7","304","305","","assignees.assignee",[1, 1, array_index])
        fact_obj.language := none
        fact_obj.input := none
        list_add(facts,fact_obj)
      end if 
      
      if assignee_self.@tsip:legalType then 
          fact_obj := fact_get("assignees.assignee.legalType",assignee_self.@tsip:legalType,"7","304","306","","assignees.assignee",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)
      end if 

      if assignee_self.@tsip:no then 
          fact_obj := fact_get("assignees.assignee.no",assignee_self.@tsip:no,"7","304","309","","assignees.assignee",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)
      end if 

      if assignee_self.@tsip:src then 
          fact_obj := fact_get("assignees.assignee.src",assignee_self.@tsip:src,"7","304","307","","assignees.assignee",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)
      end if 
  
      if assignee_self.@tsip:refId then 
          fact_obj := fact_get("assignees.assignee.refId",assignee_self.@tsip:refId,"7","304","308","","assignees.assignee",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)
      end if
    
      fact_obj := fact_get("assignees.assignee.content",assignee_self.xml,"7","304","343","","assignees.assignee",[1, 1])
      fact_obj.language := none
      fact_obj.input := none
      list_add(facts,fact_obj)
      
      for assignee_child in assignee_as_list loop 
        if (assignee_child._internal_ = "assigneeTotal") then 

          if assignee_child.@tsip:form then 
              fact_obj := fact_get("assignees.assignee.assigneeTotal.form",assignee_child.@tsip:form,"7","319","321","","assignees.assignee.assigneeTotal",[1, 1, array_index, 1])
              fact_obj.language := none
              fact_obj.input := none
              list_add(facts,fact_obj)
          end if 
      
          if assignee_child.@tsip:refId then 
              fact_obj := fact_get("assignees.assignee.assigneeTotal.refId",assignee_child.@tsip:refId,"7","319","322","","assignees.assignee.assigneeTotal",[1, 1, array_index, 1])
              fact_obj.language := none
              fact_obj.input := none
              list_add(facts,fact_obj)
          end if 
          

          fact_obj := fact_get("assignees.assignee.assigneeTotal.content",assignee_child.assigneeTotal,"7","319","320","","assignees.assignee.assigneeTotal",[1, 1, array_index, 1])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)

        else if (assignee_child._internal_ = "name") then
          name_as_list := assignee_child.name as list 
          for name_child in name_as_list loop
            if (name_child._internal_ = "nameTotal") then 
              if name_child.@tsip:form then 
                  fact_obj := fact_get("assignees.assignee.name.nameTotal.form",name_child.@tsip:form,"7","328","330","","assignees.assignee.name.nameTotal",[1, 1, array_index, 1, 1])
                  fact_obj.language := none
                  fact_obj.input := none
                  list_add(facts,fact_obj)
              end if 
              
          
              if name_child.@tsip:refId then 
                  fact_obj := fact_get("assignees.assignee.name.nameTotal.refId",name_child.@tsip:refId,"7","328","332","","assignees.assignee.name.nameTotal+F89",[1, 1, array_index, 1, 1])
                  fact_obj.language := none
                  fact_obj.input := none
                  list_add(facts,fact_obj)
              end if 
              
          
              if name_child.@tsip:src then 
                  fact_obj := fact_get("assignees.assignee.name.nameTotal.src",name_child.@tsip:src,"7","328","331","","assignees.assignee.name.nameTotal",[1, 1, array_index, 1, 1])
                  fact_obj.language := none
                  fact_obj.input := none
                  list_add(facts,fact_obj)
              end if 
              
          
              if name_child.nameTotal then 
                  fact_obj := fact_get("assignees.assignee.name.nameTotal.content",name_child.nameTotal,"7","328","329","","assignees.assignee.name.nameTotal",[1, 1, array_index, 1])
                  fact_obj.language := none
                  fact_obj.input := none
                  list_add(facts,fact_obj)
              end if             
            
            else if (name_child._internal_ = "surname") then 
                fact_obj := fact_get("assignees.assignee.name.surname",name_child.surname,"7","326","333","","assignees.assignee.name",[1, 1, array_index, 1])
                fact_obj.language := none
                fact_obj.input := none
                list_add(facts,fact_obj)

            else if (name_child._internal_ = "forenames") then 
              fact_obj := fact_get("assignees.assignee.name.forenames",name_child.forenames,"7","326","327","","assignees.assignee.name",[1, 1, array_index, 1])
              fact_obj.language := none
              fact_obj.input := none
              list_add(facts,fact_obj)
            end if 
          end loop 
          
        else if (assignee_child._internal_ = "address") then 
          address_as_list := assignee_child.address as list 
          
          for address_child in address_as_list loop 
            if (address_child._internal_ = "addressTotal") then 
              
              fact_obj := fact_get("assignees.assignee.address.addressTotal",address_child.addressTotal,"7","310","311","","assignees.assignee.address",[1, 1, array_index, 1])
              fact_obj.language := none
              fact_obj.input := none
              list_add(facts,fact_obj)
              
              
            
              
            else if (address_child._internal_ = "addressLine") then 
              if address_child.@tsip:no then 
                fact_obj := fact_get("assignees.assignee.address.addressLine.no", address_child.@tsip:no, "7","316","318","","assignees.assignee.address.addressLine",[1, 1, array_index, 1, 1])
                fact_obj.language := none
                fact_obj.input := none
                list_add(facts,fact_obj)
              end if 
              
              if address_child.addressLine then 
                  fact_obj := fact_get("assignees.assignee.address.addressLine.content",address_child.addressLine,"7","316","317","","assignees.assignee.address",[1, 1, array_index, 1])
                  fact_obj.language := none
                  fact_obj.input := none
                  list_add(facts,fact_obj)
              end if 
            
            else if (address_child._internal_ = "postalCode") then 
      				fact_obj := fact_get("assignees.assignee.address.postalCode",address_child.postalCode,"7","310","315","","assignees.assignee.address",[1, 1, array_index, 1])
      				fact_obj.language := none
      				fact_obj.input := none
      				list_add(facts,fact_obj)
            
            else if (address_child._internal_ = "city") then 

              fact_obj := fact_get("assignees.assignee.address.city",address_child.city,"7","310","312","","assignees.assignee.address",[1, 1, array_index, 1])
              fact_obj.language := none
              fact_obj.input := none
              list_add(facts,fact_obj)
          

            
            else if (address_child._internal_ = "state") then 
			
      				fact_obj := fact_get("assignees.assignee.address.state",address_child.state,"7","310","314","","assignees.assignee.address",[1, 1, array_index, 1])
      				fact_obj.language := none
      				fact_obj.input := none
      				list_add(facts,fact_obj)
                  
            else if (address_child._internal_ = "countryCode") then 
              fact_obj := fact_get("assignees.assignee.address.countryCode",address_child.countryCode,"7","310","313","","assignees.assignee.address",[1, 1, array_index, 1])
              fact_obj.language := none
              fact_obj.input := none
              list_add(facts,fact_obj)
            
            end if 
          end loop 
        
        else if (assignee_child._internal_ = "limitation") then 
          fact_obj := fact_get("assignees.assignee.limitation.content",assignee_child.limitation,"7","323","324","","assignees.assignee.limitation",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)

          if assignee_child.@tsip:type then 
            fact_obj := fact_get("assignees.assignee.limitation.type",assignee_child.@tsip:type,"7","323","325","","assignees.assignee.limitation",[1, 1, array_index, 1])
            fact_obj.language := none
            fact_obj.input := none
            list_add(facts,fact_obj)
          end if 

        else if (assignee_child._internal_ = "residence") then 
          fact_obj := fact_get("assignees.assignee.residence",assignee_child.residence,"7","304","334","","assignees.assignee",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)
        
        else if (assignee_child._internal_ = "nationality") then 
          fact_obj := fact_get("assignees.assignee.nationality",assignee_child.nationality,"7","304","335","","assignees.assignee",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)
        
        else if (assignee_child._internal_ = "assigneeNumber") then 
          if assignee_child.@tsip:src then 
            fact_obj := fact_get("assignees.assignee.assigneeNumber.src",assignee_child.@tsip:src,"7","336","337","","assignees.assignee.assigneeNumber",[1, 1, array_index, 1])
            fact_obj.language := none
            fact_obj.input := none
            list_add(facts,fact_obj)
          end if 

          fact_obj := fact_get("assignees.assignee.assigneeNumber.content",assignee_child.assigneeNumber,"7","336","338","","assignees.assignee.assigneeNumber",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)

        else if (assignee_child._internal_ = "assigneeCode") then
          if assignee_child.@tsip:codeType then 
            fact_obj := fact_get("assignees.assignee.assigneeCode.codeType",assignee_child.@tsip:codeType,"7","339","341","","assignees.assignee.assigneeCode",[1, 1, array_index, 1])
            fact_obj.language := none
            fact_obj.input := none
            list_add(facts,fact_obj)
          end if 
          
          if assignee_child.@tsip:src then 
            fact_obj := fact_get("assignees.assignee.assigneeCode.src",assignee_child.@tsip:src,"7","339","340","","assignees.assignee.assigneeCode",[1, 1, array_index, 1])
            fact_obj.language := none
            fact_obj.input := none
            list_add(facts,fact_obj)
          end if 
          
          fact_obj := fact_get("assignees.assignee.assigneeCode.content",assignee_child.assigneeCode,"7","339","342","","assignees.assignee.assigneeCode",[1, 1, array_index])
          fact_obj.language := none
          fact_obj.input := none
          list_add(facts,fact_obj)
        end if
      end loop
     
      if array_index = 1 then
          assignees_self := list_self(assignees)
          list_add(facts ,fact_get("assignees.assignee.content",assignees_self.xml,"7","304","343",none,"assignees.assignee",[1, 1, 1]))
      end if 
      
      relationship_node.additionalFacts := facts
      list_add(output.patent.relationships, relationship_node)
      array_index := array_index + 1
    end if
    

  end loop 
  end if 
  ######### END FACT: ASSIGNEES ############################

end rule
begin rule "patentCitations"


	if input.patent.patentCitations then 
		patentCitations_as_list := input.patent.patentCitations as list 
		patentCitations_self := list_self(patentCitations_as_list)
		

		array_index := 1

		if patentCitations_self.@tsip:noCitations then 
			fact_obj := fact_get("patentCitations.noCitations", patentCitations_self.@tsip:noCitations,"7","415","509","","patentCitations",[1,1])
			fact_obj.language := none
			fact_obj.input := none
			list_add(output.patent.factValues,fact_obj)
		end if 

		fact_obj := fact_get("patentCitations.content",patentCitations_self.xml,"7","415","741","","patentCitations",[1,1])
		fact_obj.language := none
		fact_obj.input := none
		list_add(output.patent.factValues,fact_obj)

		for patentCitations_child in patentCitations_as_list loop 

			if patentCitations_child._internal_ = "fieldOfSearch" then 
				fieldOfSearch_as_list := patentCitations_child.fieldOfSearch as list 
				fieldOfSearch_self := list_self(fieldOfSearch_as_list)
				
				if fieldOfSearch_self.@tsip:available then 
					fact_obj := fact_get("patentCitations.fieldOfSearch.available",fieldOfSearch_self.@tsip:available,"7","416","417","","patentCitations.fieldOfSearch",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 
				
				for fieldOfSearch_child in fieldOfSearch_as_list loop 

					if fieldOfSearch_child._internal_ =  "classificationIpc" then 
						classificationIpc_as_list := fieldOfSearch_child.classificationIpc as list 
						classificationIpc_self := list_self(classificationIpc_as_list)
						
						if classificationIpc_self.@tsip:action then 
							fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.action",classificationIpc_self.@tsip:action,"7","441","442","","patentCitations.fieldOfSearch.classificationIpc",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						for classificationIpc_child in classificationIpc_as_list loop 

							if classificationIpc_child.ipc then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.text",classificationIpc_child.ipc,"7","443","784","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
										
							if classificationIpc_child.@tsip:actionDate then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.actionDate",classificationIpc_child.@tsip:actionDate,"7","443","444","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:applied then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.applied",classificationIpc_child.@tsip:applied,"7","443","445","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:classLevel then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.classLevel",classificationIpc_child.@tsip:classLevel,"7","443","446","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:error then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.error",classificationIpc_child.@tsip:error,"7","443","447","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:level then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.level",classificationIpc_child.@tsip:level,"7","443","448","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:linker then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.linker",classificationIpc_child.@tsip:linker,"7","443","449","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:office then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.office",classificationIpc_child.@tsip:office,"7","443","450","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:position then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.position",classificationIpc_child.@tsip:position,"7","443","451","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:rank then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.rank",classificationIpc_child.@tsip:rank,"7","443","452","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:scope then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.scope",classificationIpc_child.@tsip:scope,"7","443","453","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:type then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.type",classificationIpc_child.@tsip:type,"7","443","454","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationIpc_child.@tsip:version then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationIpc.ipc.version",classificationIpc_child.@tsip:version,"7","443","455","","patentCitations.fieldOfSearch.classificationIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						end loop 

					else if fieldOfSearch_child._internal_ =  "classificationEcla" then 
						classificationEcla_as_list := fieldOfSearch_child.classificationEcla as list 
						classificationEcla_self := list_self(classificationEcla_as_list)
						
						if classificationEcla_self.@tsip:action then 
							fact_obj := fact_get("patentCitations.fieldOfSearch.classificationEcla.action",classificationEcla_self.@tsip:action ,"7","433","434","","patentCitations.fieldOfSearch.classificationEcla",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						for classificationEcla_child in classificationEcla_as_list loop 
							if classificationEcla_child._internal_ = "ecla" then 
								if classificationEcla_child.@tsip:type then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationEcla.ecla.type",classificationEcla_child.@tsip:type,"7","435","436","","patentCitations.fieldOfSearch.classificationEcla.ecla",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

							else if classificationEcla_child._internal_ = "ecno" then 

								if classificationEcla_child.@tsip:office then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationEcla.ecno.office",classificationEcla_child.@tsip:office,"7","437","438","","patentCitations.fieldOfSearch.classificationEcla.ecno",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 			
							end if 
						end loop 
					
					else if fieldOfSearch_child._internal_ =  "classificationCpc" then 
						classificationCpc_as_list := fieldOfSearch_child.classificationCpc as list 
						classificationCpc_self := list_self(classificationCpc_as_list)
						
						if classificationCpc_self.@tsip:action then 
							fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.action",classificationCpc_self.@tsip:action ,"7","418","419","","patentCitations.fieldOfSearch.classificationCpc",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						for classificationCpc_child in classificationCpc_as_list loop 
					
							if classificationCpc_child.cpc then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.text",classificationCpc_child.cpc,"7","420","783","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
							
							if classificationCpc_child.@tsip:actionDate then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.actionDate",classificationCpc_child.@tsip:actionDate ,"7","420","421","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationCpc_child.@tsip:applied then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.applied",classificationCpc_child.@tsip:applied,"7","420","422","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
							
							if classificationCpc_child.@tsip:error then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.error",classificationCpc_child.@tsip:error,"7","420","423","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
								
							if classificationCpc_child.@tsip:level then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.level",classificationCpc_child.@tsip:level,"7","420","424","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationCpc_child.@tsip:linker then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.linker",classificationCpc_child.@tsip:linker,"7","420","425","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
							
							if classificationCpc_child.@tsip:office then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.office",classificationCpc_child.@tsip:office,"7","420","426","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
							
							if classificationCpc_child.@tsip:position then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.position",classificationCpc_child.@tsip:position,"7","420","427","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						
							if classificationCpc_child.@tsip:rangeFrom then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.rangeFrom",classificationCpc_child.@tsip:rangeFrom,"7","420","428","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						
							if classificationCpc_child.@tsip:rangeTo then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.rangeTo",classificationCpc_child.@tsip:rangeTo,"7","420","429","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						
							if classificationCpc_child.@tsip:schemeOrigin then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.schemeOrigin",classificationCpc_child.@tsip:schemeOrigin,"7","420","430","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						
							if classificationCpc_child.@tsip:scope then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.scope",classificationCpc_child.@tsip:scope,"7","420","431","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						
							if classificationCpc_child.@tsip:version then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationCpc.cpc.version",classificationCpc_child.@tsip:version,"7","420","432","","patentCitations.fieldOfSearch.classificationCpc.cpc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						end loop 

					else if fieldOfSearch_child._internal_ =  "classificationUs" then 
						classificationUs_as_list := fieldOfSearch_child.classificationUs as list
						classificationUs_self := list_self(classificationUs_as_list)
						
						if classificationUs_self.@tsip:action then 
							fact_obj := fact_get("patentCitations.fieldOfSearch.classificationUs.action", classificationUs_self.@tsip:action ,"7","498","499","","patentCitations.fieldOfSearch.classificationUs",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						for classificationUs_child in classificationUs_as_list loop 
							if patent.patentCitations.fieldOfSearch.classificationUs.uspc.rangeFrom then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationUs.uspc.rangeFrom",patent.patentCitations.fieldOfSearch.classificationUs.uspc.rangeFrom,"7","500","502","","patentCitations.fieldOfSearch.classificationUs.uspc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationUs_child.@tsip:rangeTo then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationUs.uspc.rangeTo", classificationUs_child.@tsip:rangeTo,"7","500","503","","patentCitations.fieldOfSearch.classificationUs.uspc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
							
							if classificationUs_child.@tsip:subclass then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationUs.uspc.subclass",classificationUs_child.@tsip:subclass,"7","500","504","","patentCitations.fieldOfSearch.classificationUs.uspc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if classificationUs_child.@tsip:type then 
								fact_obj := fact_get("patentCitations.fieldOfSearch.classificationUs.uspc.type",classificationUs_child.@tsip:type,"7","500","505","","patentCitations.fieldOfSearch.classificationUs.uspc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						
						end loop
					
					else if fieldOfSearch_child._internal_ =  "classificationJp" then 
						classificationJp_as_list := fieldOfSearch_child.classificationJp as list 
						classificationJp_self := list_self(classificationJp_as_list)
						
						if classificationJp_self.@tsip:action then 
							fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.action",classificationJp_self.@tsip:action,"7","456","457","","patentCitations.fieldOfSearch.classificationJp",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						for classificationJp_child in classificationJp_as_list loop 
							if classificationJp_child._internal_ = "jppc" then 
								if classificationJp_child.jppc then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.text",classificationJp_child.jppc,"7","461","785","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if classificationJp_child.@tsip:error then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.error",classificationJp_child.@tsip:error,"7","461","462","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if classificationJp_child.@tsip:jpFacet then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.jpFacet",classificationJp_child.@tsip:jpFacet,"7","461","464","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 


								if classificationJp_child.@tsip:rangeFrom then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.rangeFrom",classificationJp_child.@tsip:rangeFrom,"7","461","465","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if classificationJp_child.@tsip:rangeTo then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.rangeTo",classificationJp_child.@tsip:rangeTo,"7","461","466","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if classificationJp_child.@tsip:rank then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.rank",classificationJp_child.@tsip:rank,"7","461","467","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if classificationJp_child.@tsip:type then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.ipcType",classificationJp_child.@tsip:type,"7","461","463","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if classificationJp_child.@tsip:version then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.jppc.version",classificationJp_child.@tsip:version,"7","461","468","","patentCitations.fieldOfSearch.classificationJp.jppc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 
							
							else if classificationJp_child._internal_ = "fClass" then
								if classificationJp_child.fClass.fTerm then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.fClass.fTerm", classificationJp_child.fClass.fTerm ,"7","458","459","","patentCitations.fieldOfSearch.classificationJp.fClass",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 
								
								if classificationJp_child.fClass.theme then 
									fact_obj := fact_get("patentCitations.fieldOfSearch.classificationJp.fClass.theme",classificationJp_child.fClass.theme ,"7","458","460","","patentCitations.fieldOfSearch.classificationJp.fClass",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

							end if 
						
						end loop 
									
					end if 
				
				end loop

			else if patentCitations_child._internal_ = "patCitation" then 
				patCitation_as_list :=  patentCitations_child.patCitation as list 
				patCitation_self := list_self(patCitation_as_list)
				
				fact_obj := fact_get("patentCitations.patCitation.patCitAscontent",patCitation_self.xml,"7","510","651","","patentCitations.patCitation",[1,1,array_index])
				fact_obj.language := none
				fact_obj.input := none
				list_add(output.patent.factValues,fact_obj) 
				
				if patCitation_self.@tsip:category then 
					fact_obj := fact_get("patentCitations.patCitation.category",patCitation_self.@tsip:category,"7","510","522","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 
					
				if patCitation_self.@tsip:cc then 
					fact_obj := fact_get("patentCitations.patCitation.patentCountryOptional",patCitation_self.@tsip:cc,"7","510","653","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:citDate  then 
					fact_obj := fact_get("patentCitations.patCitation.citDate",patCitation_self.@tsip:citDate ,"7","510","523","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:citingParty then 
					fact_obj := fact_get("patentCitations.patCitation.citingParty",patCitation_self.@tsip:citingParty,"7","510","636","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:ki then 
					fact_obj := fact_get("patentCitations.patCitation.patentKindOptional",patCitation_self.@tsip:ki,"7","510","654","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:noCitations  then 
					fact_obj := fact_get("patentCitations.patCitation.noCitations",patCitation_self.@tsip:noCitations ,"7","510","649","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:pan  then 
					fact_obj := fact_get("patentCitations.patCitation.pan",patCitation_self.@tsip:pan ,"7","510","650","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:per then 
					fact_obj := fact_get("patentCitations.patCitation.per",patCitation_self.@tsip:per,"7","510","656","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:se then 
					fact_obj := fact_get("patentCitations.patCitation.patentSerialOptional",patCitation_self.@tsip:se,"7","510","655","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:src then 
					fact_obj := fact_get("patentCitations.patCitation.src",patCitation_self.@tsip:src,"7","510","660","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				if patCitation_self.@tsip:srepcc then 
					fact_obj := fact_get("patentCitations.patCitation.srepcc",patCitation_self.@tsip:srepcc,"7","510","661","","patentCitations.patCitation",[1, 1, array_index])
					fact_obj.language := none
					fact_obj.input := none
					list_add(output.patent.factValues,fact_obj)
				end if 

				for patCitation_child in patCitation_as_list loop 
					if patCitation_child._internal_ = "documentId" then 
						documentId_as_list := patCitation_child.documentId as list 
						documentId_self := list_self(documentId_as_list)

						if documentId_self.@tsip:error then 
							fact_obj := fact_get("patentCitations.patCitation.document.docIdError",documentId_self.@tsip:error,"7","640","643","","patentCitations.patCitation.document",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 

						if documentId_self.@tsip:permId then 
							fact_obj := fact_get("patentCitations.patCitation.document.permId",documentId_self.@tsip:permId,"7","640","647","","patentCitations.patCitation.document",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 

						if documentId_self.@tsip:pubId then 
							fact_obj := fact_get("patentCitations.patCitation.document.pubId",documentId_self.@tsip:pubId,"7","640","648","","patentCitations.patCitation.document",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 

						for documentId_child in documentId_as_list loop 

							if documentId_child._internal_ = "number" then 

								fact_obj := fact_get("patentCitations.patCitation.document.number.text",documentId_child.number,"7","646","723","","patentCitations.patCitation.document.number",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

								if documentId_child.@tsip:form then 
									fact_obj := fact_get("patentCitations.patCitation.document.number.form",documentId_child.@tsip:form,"7","646","644","","patentCitations.patCitation.document.number",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 
							
							else if documentId_child._internal_ = "countryCode" then 

								fact_obj := fact_get("patentCitations.patCitation.document.countryCode",documentId_child.countryCode,"7","640","641","","patentCitations.patCitation.document",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

							else if documentId_child._internal_ = "kindCode" then 

								fact_obj := fact_get("patentCitations.patCitation.document.kindCode.text",documentId_child.kindCode,"7","645","737","","patentCitations.patCitation.document.kindCode",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

								if documentId_child.@tsip:src then 
									fact_obj := fact_get("patentCitations.patCitation.document.kindCode.source", documentId_child.@tsip:src,"7","645","738","","patentCitations.patCitation.document.kindCode",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

							else if documentId_child._internal_ = "date" then 

								fact_obj := fact_get("patentCitations.patCitation.document.date",documentId_child.date,"7","640","642","","patentCitations.patCitation.document",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

							end if 

						end loop 
					
					else if patCitation_child._internal_ = "applicationId" then 
						applicationId_as_list := patCitation_child.applicationId as list 
						applicationId_self := list_self(applicationId_as_list)
						
						if applicationId_self.@tsip:appId then 
							fact_obj := fact_get("patentCitations.patCitation.application.appId",applicationId_self.@tsip:appId ,"7","511","512","","patentCitations.patCitation.application",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						if applicationId_self.@tsip:permId then 
							fact_obj := fact_get("patentCitations.patCitation.application.permId",applicationId_self.@tsip:permId,"7","511","520","","patentCitations.patCitation.application",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						for applicationId_child in applicationId_as_list loop 

							if applicationId_child._internal_ = "applicationYear" then 
								fact_obj := fact_get("patentCitations.patCitation.application.applicationYear",applicationId_child.applicationYear,"7","511","513","","patentCitations.patCitation.application",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
							
							if applicationId_child._internal_ = "countryCode" then 
								fact_obj := fact_get("patentCitations.patCitation.application.countryCode",applicationId_child.countryCode,"7","511","514","","patentCitations.patCitation.application",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						
							if applicationId_child._internal_ = "date" then 
								fact_obj := fact_get("patentCitations.patCitation.application.date",applicationId_child.date,"7","511","515","","patentCitations.patCitation.application",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if applicationId_child._internal_ = "error" then 
								fact_obj := fact_get("patentCitations.patCitation.application.error",applicationId_child.error,"7","511","516","","patentCitations.patCitation.application",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if applicationId_child._internal_ = "kindCode" then 
								fact_obj := fact_get("patentCitations.patCitation.application.kindCode.text",applicationId_child.kindCode,"7","518","735","","patentCitations.patCitation.application.kindCode",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

								if applicationId_child.@tsip:src then 
									fact_obj := fact_get("patentCitations.patCitation.application.kindCode.source",applicationId_child.@tsip:src,"7","518","736","","patentCitations.patCitation.application.kindCode",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 
							end if 

							if applicationId_child._internal_ = "number" then 
								fact_obj := fact_get("patentCitations.patCitation.application.number.text",applicationId_child.number,"7","519","787","","patentCitations.patCitation.application.number",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

								if applicationId_child.@tsip:form then 
									fact_obj := fact_get("patentCitations.patCitation.application.number.form",applicationId_child.@tsip:form,"7","519","517","","patentCitations.patCitation.application.number",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

							end if 

							if applicationId_child._internal_ = "seriesCode" then 
								fact_obj := fact_get("patentCitations.patCitation.application.seriesCode",applicationId_child.seriesCode,"7","511","521","","patentCitations.patCitation.application",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

						end loop 

					else if patCitation_child._internal_ = "citedAssignees" then 
						citedAssignees_as_list := patCitation_child.citedAssignees as list 
						citedAssignees_self := list_self(citedAssignees_as_list)
						
						for citedAssignees_child in citedAssignees_as_list loop
							if citedAssignees_child._internal_ = "assignee" then 
								assignee_as_list := citedAssignees_child.assignee as list 
								assignee_self := list_self(assignee_as_list) 
								
								if assignee_self.@tsip:appType then 
									fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.appType",assignee_self.@tsip:appType,"7","525","534","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if assignee_self.@tsip:charSet then 
									fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.charSet", assignee_self.@tsip:charSet,"7","525","543","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if assignee_self.@tsip:legalType then 
									fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.legalType",assignee_self.@tsip:legalType,"7","525","544","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if assignee_self.@tsip:no then 
									fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.no",assignee_self.@tsip:no,"7","525","555","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if assignee_self.@tsip:refId then 
									fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.refId",assignee_self.@tsip:refId,"7","525","556","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if assignee_self.@tsip:src then 
									fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.src",assignee_self.@tsip:src,"7","525","558","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								for assignee_child in assignee_as_list loop 
									if assignee_child._internal_ = "assigneeTotal" then 

										fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeTotal.text",assignee_child.assigneeTotal,"7","539","789","","patentCitations.patCitation.citedAssignees.assignee.assigneeTotal",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

										if assignee_child.@tsip:form then 
											fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeTotal.form",assignee_child.@tsip:form,"7","540","541","","patentCitations.patCitation.citedAssignees.assignee.assigneeTotal",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 

										if assignee_child.@tsip:refId then 
											fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeTotal.refId",assignee_child.@tsip:refId,"7","540","542","","patentCitations.patCitation.citedAssignees.assignee.assigneeTotal",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 
									
									else if assignee_child._internal_ = "name" then 
										name_as_list := assignee_child.name as list 
										name_self := list_self(name_as_list)

										for name_child in name_as_list loop 
											if name_child._internal_ = "nameTotal" then 
												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.name.nameTotal.text",name_child.nameTotal,"7","549","791","","patentCitations.patCitation.citedAssignees.assignee.name.nameTotal",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

												if name_child.@tsip:form then 
													fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.name.nameTotal.form",name_child.@tsip:form,"7","549","550","","patentCitations.patCitation.citedAssignees.assignee.name.nameTotal",[1,1,array_index,1,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 

												if name_child.@tsip:refId then 
													fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.name.nameTotal.refId",name_child.@tsip:refId,"7","549","551","","patentCitations.patCitation.citedAssignees.assignee.name.nameTotal",[1,1,array_index,1,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 

												if name_child.@tsip:src then 
													fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.name.nameTotal.src",name_child.@tsip:src,"7","549","552","","patentCitations.patCitation.citedAssignees.assignee.name.nameTotal",[1,1,array_index,1,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 
				
											else if name_child._internal_ = "surname" then 
												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.name.surname",name_child.surname,"7","547","553","","patentCitations.patCitation.citedAssignees.assignee.name",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

											else if name_child._internal_ = "forenames" then 

												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.name.forenames",name_child.forenames,"7","547","548","","patentCitations.patCitation.citedAssignees.assignee.name",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

											end if 

										end loop 
								
									else if assignee_child._internal_ = "address" then 
										address_as_list := assignee_child.address as list 
										
										for address_child in address_as_list loop 
											if address_child._internal_ = "addressTotal" then 
												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.address.addressTotal",address_child.addressTotal,"7","526","529","","patentCitations.patCitation.citedAssignees.assignee.address",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

											
											else if address_child._internal_ = "addressLine" then 
												if address_child.addressLine then 
													fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.address.addressLine.text",address_child.addressLine,"7","527","786","","patentCitations.patCitation.citedAssignees.assignee.address.addressLine",[1,1,array_index,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 
												
												if address_child.@tsip:no then 
													fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.address.addressLine.no",address_child.@tsip:no,"7","527","528","","patentCitations.patCitation.citedAssignees.assignee.address.addressLine",[1,1,array_index,1,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 
											
											else if address_child._internal_ = "postalCode" then 
												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.address.postalCode",address_child.postalCode,"7","526","532","","patentCitations.patCitation.citedAssignees.assignee.address",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)
											
											else if address_child._internal_ = "city" then 
												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.address.city",address_child.city,"7","526","530","","patentCitations.patCitation.citedAssignees.assignee.address",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)
											
											else if address_child._internal_ = "state" then 
												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.address.state",address_child.state,"7","526","533","","patentCitations.patCitation.citedAssignees.assignee.address",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

											else if address_child._internal_ = "countryCode" then 
												fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.address.countryCode",address_child.countryCode,"7","526","531","","patentCitations.patCitation.citedAssignees.assignee.address",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)								
											end if 
										
										end loop 
									
									else if assignee_child._internal_ = "limitation" then 

										fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.limitation.text",assignee_child.limitation,"7","545","790","","patentCitations.patCitation.citedAssignees.assignee.limitation",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

										if assignee_child.@tsip:type then 
											fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.limitation.type",assignee_child.@tsip:type,"7","545","546","","patentCitations.patCitation.citedAssignees.assignee.limitation",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 

									else if assignee_child._internal_ = "residence" then 

										fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.residence",assignee_child.residence,"7","525","557","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)
									
									else if assignee_child._internal_ = "nationality" then 
										fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.nationality",assignee_child.nationality,"7","525","554","","patentCitations.patCitation.citedAssignees.Assignee",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

									else if assignee_child._internal_ = "assigneeNumber" then 

										fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeNumber.text",assignee_child.assigneeNumber,"7","538","788","","patentCitations.patCitation.citedAssignees.assignee.assigneeNumber",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

										if assignee_child.@tsip:src then 
											fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeNumber.src",assignee_child.@tsip:src,"7","538","539","","patentCitations.patCitation.citedAssignees.assignee.assigneeNumber",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 
									
									else if assignee_child._internal_ = "assigneeCode" then 

										fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeCode.text",assignee_child.assigneeCode,"7","535","787","","patentCitations.patCitation.citedAssignees.assignee.assigneeCode",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

										if assignee_child.@tsip:codeType then 
											fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeCode.codeType",assignee_child.@tsip:codeType,"7","535","536","","patentCitations.patCitation.citedAssignees.assignee.assigneeCode",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 

										if assignee_child.@tsip:src then 
											fact_obj := fact_get("patentCitations.patCitation.citedAssignees.assignee.assigneeCode.src",assignee_child.@tsip:src,"7","535","537","","patentCitations.patCitation.citedAssignees.assignee.assigneeCode",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 
									
									end if 
								end loop 

							end if 
						
						end loop 
					
					else if patCitation_child._internal_ = "citedInventors" then 
						citedInventors_as_list := patCitation_child.citedInventors as list 
						citedInventors_self := list_self(citedInventors_as_list)   

						for citedInventors_child in citedInventors_as_list loop 
							if citedInventors_child._internal_ = "inventor" then  
								inventor_as_list := citedInventors_child.inventor as list 
								inventor_self := list_self(inventor_as_list)

								if inventor_self.@tsip:charSet then 
									fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.charSet",inventor_self.@tsip:charSet,"7","574","583","","patentCitations.patCitation.citedInventors.inventor",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if inventor_self.tsip:no then 
									fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.no",inventor_self.tsip:no,"7","574","597","","patentCitations.patCitation.citedInventors.inventor",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if inventor_self.tsip:refId then 
									fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.refId",inventor_self.tsip:refId,"7","574","598","","patentCitations.patCitation.citedInventors.inventor",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if inventor_self.@tsip:src then 
									fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.src",inventor_self.@tsip:src,"7","574","600","","patentCitations.patCitation.citedInventors.inventor",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								for inventor_child in inventor_as_list loop 
									if inventor_child._internal_ = "inventorTotal" then 

										fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.inventorTotal.text",inventor_child.inventorTotal,"7","584","794","","patentCitations.patCitation.citedInventors.inventor.inventorTotal",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

										if inventor_child.@tsip:form then 
											fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.inventorTotal.form",inventor_child.@tsip:form,"7","584","585","","patentCitations.patCitation.citedInventors.inventor.inventorTotal",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 

										if inventor_child.@tsip:refId then 
											fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.inventorTotal.refId",inventor_child.@tsip:refId,"7","584","586","","patentCitations.patCitation.citedInventors.inventor.inventorTotal",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 

									else if inventor_child._internal_ = "name" then 
										name_as_list := inventor_child.name as list 
										name_self := list_self(name_as_list)

										for name_child in name_as_list loop 
											if name_child._internal_ = "nameTotal" then 

												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.name.nameTotal.text",name_child.nameTotal,"7","591","796","","patentCitations.patCitation.citedInventors.inventor.name.nameTotal",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

												if name_child.@tsip:form then 
													fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.name.nameTotal.form",name_child.@tsip:form,"7","591","592","","patentCitations.patCitation.citedInventors.inventor.name.nameTotal",[1,1,array_index,1,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 

												if name_child.@tsip:refId then 
													fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.name.nameTotal.refId",name_child.@tsip:refId,"7","591","593","","patentCitations.patCitation.citedInventors.inventor.name.nameTotal",[1,1,array_index,1,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 
												
												if name_child.@tsip:src then 
													fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.name.nameTotal.src",name_child.@tsip:src,"7","591","594","","patentCitations.patCitation.citedInventors.inventor.name.nameTotal",[1,1,array_index,1,1,1,1])
													fact_obj.language := none
													fact_obj.input := none
													list_add(output.patent.factValues,fact_obj)
												end if 

											else if name_child._internal_ = "surname" then

												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.name.surname",name_child.surname,"7","589","595","","patentCitations.patCitation.citedInventors.inventor.name",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

											else if name_child._internal_ = "forenames" then 
												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.name.forenames",name_child.forenames,"7","589","590","","patentCitations.patCitation.citedInventors.inventor.name",[1,1,array_index,1,1,1])
												fact_obj.language := none
												fact_obj.input := none
												list_add(output.patent.factValues,fact_obj)

											end if 

										end loop 

									else if inventor_child._internal_ = "address" then 
									  if inventor_child.address then 
  										address_as_list := inventor_child.address as list
  										address_self := list_self(address_as_list) 

                      for address_child in address_as_list loop 
  											if address_child._internal_ = "addressTotal" then 
  												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.address.addressTotal",address_child.addressTotal,"7","575","578","","patentCitations.patCitation.citedInventors.inventor.address",[1,1,array_index,1,1,1])
  												fact_obj.language := none
  												fact_obj.input := none
  												list_add(output.patent.factValues,fact_obj)
  
  											else if address_child._internal_ = "addressLine" then 
  
  												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.address.addressLine.text",address_child.addressLine,"7","576","793","","patentCitations.patCitation.citedInventors.inventor.address.addressLine",[1,1,array_index,1,1,1])
  												fact_obj.language := none
  												fact_obj.input := none
  												list_add(output.patent.factValues,fact_obj)
  
  												if address_child.@tsip:no then 
  													fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.address.addressLine.no",address_child.@tsip:no,"7","576","577","","patentCitations.patCitation.citedInventors.inventor.address.addressLine",[1,1,array_index,1,1,1,1])
  													fact_obj.language := none
  													fact_obj.input := none
  													list_add(output.patent.factValues,fact_obj)
  												end if 
  
  											else if address_child._internal_ = "postalCode" then 
  
  												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.address.postalCode",address_child.postalCode,"7","575","581","","patentCitations.patCitation.citedInventors.inventor.address",[1,1,array_index,1,1,1])
  												fact_obj.language := none
  												fact_obj.input := none
  												list_add(output.patent.factValues,fact_obj)
  
  											else if address_child._internal_ = "city" then 
  
  												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.address.city",address_child.city,"7","575","579","","patentCitations.patCitation.citedInventors.inventor.address",[1,1,array_index,1,1,1])
  												fact_obj.language := none
  												fact_obj.input := none
  												list_add(output.patent.factValues,fact_obj)
  
  											else if address_child._internal_ = "state" then 
  
  												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.address.state",address_child.state,"7","575","582","","patentCitations.patCitation.citedInventors.inventor.address",[1,1,array_index,1,1,1])
  												fact_obj.language := none
  												fact_obj.input := none
  												list_add(output.patent.factValues,fact_obj)
  
  											else if address_child._internal_ = "countryCode" then 
  
  												fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.address.countryCode",address_child.countryCode,"7","575","580","","patentCitations.patCitation.citedInventors.inventor.address",[1,1,array_index,1,1,1])
  												fact_obj.language := none
  												fact_obj.input := none
  												list_add(output.patent.factValues,fact_obj)
  
  											end if 
  
  										end loop 
										
									  end if 

									else if inventor_child._internal_ = "limitation" then 

										fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.limitation.text",inventor_child.limitation,"7","587","795","","patentCitations.patCitation.citedInventors.inventor.limitation",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

										if inventor_child.@tsip:type then 
											fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.limitation.type",inventor_child.@tsip:type,"7","587","588","","patentCitations.patCitation.citedInventors.inventor.limitation",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 

									else if inventor_child._internal_ = "residence" then

										fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.residence",inventor_child.residence,"7","574","599","","patentCitations.patCitation.citedInventors.inventor",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)
				
									else if inventor_child._internal_ = "nationality" then 

										fact_obj := fact_get("patentCitations.patCitation.citedInventors.inventor.nationality",inventor_child.nationality,"7","574","596","","patentCitations.patCitation.citedInventors.inventor",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)
									
									end if 

								end loop 

							end if 

						end loop 
					
					else if patCitation_child._internal_ = "citedIpc" then
						citedIpc_as_list := patCitation_child.citedIpc as list 
						citedIpc_self := list_self(citedIpc_as_list)

						for citedIpc_child in citedIpc_as_list loop 
							fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.text",citedIpc_child.ipc,"7","601","797","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
								
							if citedIpc_child.@tsip:actionDate then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.actionDate",citedIpc_child.@tsip:actionDate,"7","602","603","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:applied then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.applied",citedIpc_child.@tsip:applied,"7","602","604","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:classLevel then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.classLevel",citedIpc_child.@tsip:classLevel,"7","602","605","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:error then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.error",citedIpc_child.@tsip:error,"7","602","606","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:level then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.level",citedIpc_child.@tsip:level,"7","602","607","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:linker then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.linker",citedIpc_child.@tsip:linker,"7","602","608","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:office then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.office",citedIpc_child.@tsip:office,"7","602","609","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:position then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.position",citedIpc_child.@tsip:position,"7","602","610","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:rank then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.rank",citedIpc_child.@tsip:rank,"7","602","611","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:scope then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.scope",citedIpc_child.@tsip:scope,"7","602","612","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:type then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.type",citedIpc_child.@tsip:type,"7","602","613","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 

							if citedIpc_child.@tsip:version then 
								fact_obj := fact_get("patentCitations.patCitation.citedIpc.ipc.version",citedIpc_child.@tsip:version,"7","602","614","","patentCitations.patCitation.citedIpc.ipc",[1,1,array_index,1,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)
							end if 
						end loop 

					else if patCitation_child._internal_ = "citedUs" then 
						citedUs_as_list := patCitation_child.citedUs as list 
						citedUs_self := list_self(citedUs_as_list)

						for citedUs_child in citedUs_as_list loop
							if citedUs_child._internal_ = "uspc" then
								uspc_as_list := citedUs_child.uspc as list 
								uspc_self := list_self(uspc_as_list)

								if uspc_self.@tsip:rangeFrom then 
									fact_obj := fact_get("patentCitations.patCitation.citedUs.uspc.rangeFrom",uspc_self.@tsip:rangeFrom,"7","630","632","","patentCitations.patCitation.citedUs.uspc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if uspc_self.@tsip:rangeTo then 
									fact_obj := fact_get("patentCitations.patCitation.citedUs.uspc.rangeTo",uspc_self.@tsip:rangeTo,"7","630","633","","patentCitations.patCitation.citedUs.uspc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if uspc_self.@tsip:type then 
									fact_obj := fact_get("patentCitations.patCitation.citedUs.uspc.type",uspc_self.@tsip:type,"7","630","635","","patentCitations.patCitation.citedUs.uspc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								for uspc_child in uspc_as_list loop 

									if uspc_child._internal_ = "mainclass" then

										fact_obj := fact_get("patentCitations.patCitation.citedUs.uspc.mainclass",citedUs_child.mainclass,"7","630","631","","patentCitations.patCitation.citedUs.uspc",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

									else if uspc_child._internal_ = "subclass" then 

										fact_obj := fact_get("patentCitations.patCitation.citedUs.uspc.subclass",uspc_child.subclass,"7","630","634","","patentCitations.patCitation.citedUs.uspc",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

									end if

								end loop 

							end if  

						end loop   
					
					else if patCitation_child._internal_ = "citedCpc" then 
						citedCpc_as_list := patCitation_child.citedCpc as list 
						citedCpc_self := list_self(citedCpc_as_list)

						for citedCpc_child in citedCpc_as_list loop 
							if citedCpc_child._internal_ = "cpc" then 

								fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.text",citedCpc_child.cpc,"7","560","792","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

								if citedCpc_child.@tsip:actionDate then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.actionDate",citedCpc_child.@tsip:actionDate,"7","560","561","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:applied then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.applied",citedCpc_child.@tsip:applied,"7","560","562","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:error then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.error",citedCpc_child.@tsip:error,"7","560","563","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:level then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.level",citedCpc_child.@tsip:level,"7","560","564","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 
								
								if citedCpc_child.@tsip:linker then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.linker",citedCpc_child.@tsip:linker,"7","560","565","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:office then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.office",citedCpc_child.@tsip:office,"7","560","566","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:position then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.position",citedCpc_child.@tsip:position,"7","560","567","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:rangeFrom then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.rangeFrom",citedCpc_child.@tsip:rangeFrom,"7","560","568","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:rangeTo then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.rangeTo",citedCpc_child.@tsip:rangeTo,"7","560","569","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:schemeOrigin then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.schemeOrigin",citedCpc_child.@tsip:schemeOrigin,"7","560","570","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:scope then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.scope",citedCpc_child.@tsip:scope,"7","560","571","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if citedCpc_child.@tsip:version then 
									fact_obj := fact_get("patentCitations.patCitation.citedCpc.cpc.version",citedCpc_child.@tsip:version,"7","560","572","","patentCitations.patCitation.citedCpc.cpc",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

							end if 

						end loop 

					else if patCitation_child._internal_ = "citedTitles" then 
						citedTitles_as_list := patCitation_child.citedTitles as list 
						citedTitles_self := list_self(citedTitles_as_list)

						for citedTitles_child in citedTitles_as_list loop 
							if citedTitles_child._internal_ = "title" then 
								title_as_list := citedTitles_child.title as list 
								title_self := list_self(title_as_list)

								fact_obj := fact_get("patentCitations.patCitation.citedTitles.title.text",title_self.xml,"7","616","739","","patentCitations.patCitation.citedTitles.title",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

								if title_self.@tsip:input then 
									fact_obj := fact_get("patentCitations.patCitation.citedTitles.title.input", title_self.@tsip:input,"7","616","617","","patentCitations.patCitation.citedTitles.title",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if  title_self.@tsip:lang then 
									fact_obj := fact_get("patentCitations.patCitation.citedTitles.title.lang", title_self.@tsip:lang,"7","616","618","","patentCitations.patCitation.citedTitles.title",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

							else if citedTitles_child._internal_ = "titleAscii" then 
								titleAscii_as_list := citedTitles_child.titleAscii as list 
								titleAscii_self := list_self(titleAscii_as_list)

								if titleAscii_self.@tsip:input then 
									fact_obj := fact_get("patentCitations.patCitation.citedTitles.titleAscii.input",titleAscii_self.@tsip:input,"7","619","620","","patentCitations.patCitation.citedTitles.titleAscii",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								if titleAscii_self.@tsip:lang then 
									fact_obj := fact_get("patentCitations.patCitation.citedTitles.titleAscii.lang",titleAscii_self.@tsip:lang,"7","619","621","","patentCitations.patCitation.citedTitles.titleAscii",[1,1,array_index,1,1])
									fact_obj.language := none
									fact_obj.input := none
									list_add(output.patent.factValues,fact_obj)
								end if 

								for titleAscii_child in titleAscii_as_list loop 
									if titleAscii_child._internal_ = "titlePartAscii" then 

										fact_obj := fact_get("patentCitations.patCitation.citedTitles.titleAscii.titlePartAscii.text",titleAscii_child.titlePartAscii,"7","622","740","","patentCitations.patCitation.citedTitles.titleAscii.titlePartAscii",[1,1,array_index,1,1])
										fact_obj.language := none
										fact_obj.input := none
										list_add(output.patent.factValues,fact_obj)

										if titleAscii_child.@tsip:no then 
											fact_obj := fact_get("patentCitations.patCitation.citedTitles.titleAscii.titlePartAscii.no",titleAscii_child.@tsip:no,"7","622","623","","patentCitations.patCitation.citedTitles.titleAscii.titlePartAscii",[1,1,array_index,1,1,1])
											fact_obj.language := none
											fact_obj.input := none
											list_add(output.patent.factValues,fact_obj)
										end if 

									end if 

								end loop 

							end if 

						end loop 
					
					else if patCitation_child._internal_ = "relevantClaims" then 
						fact_obj := fact_get("patentCitations.patCitation.relevantClaims",patCitation_child.relevantClaims,"7","510","657","","patentCitations.patCitation",[1, 1, array_index])
						fact_obj.language := none
						fact_obj.input := none
						list_add(output.patent.factValues,fact_obj)
					
					else if patCitation_child._internal_ = "patCitAsText" then 
						
						if patCitation_child.@tsip:refId then 
							fact_obj := fact_get("patentCitations.patCitation.patCitAscontent.refId",patCitation_child.@tsip:refId,"7","651","652","","patentCitations.patCitation.patCitAscontent",[1,1,array_index,1])
							fact_obj.language := none
							fact_obj.input := none
							list_add(output.patent.factValues,fact_obj)
						end if 
						
						fact_obj := fact_get("patentCitations.patCitation.patCitAscontent.text",patCitation_child.patCitAsText,"7","651","798","","patentCitations.patCitation.patCitAscontent",[1,1,array_index,1])
						fact_obj.language := none
						fact_obj.input := none
						list_add(output.patent.factValues,fact_obj)
					
					else if patCitation_child._internal_ = "correspondingDocs" then 
						correspondingDocs_as_list := patCitation_child.correspondingDocs as list 

						for correspondingDocs_child in correspondingDocs_as_list loop 
							if correspondingDocs_child._internal_ = "patCitation" then 
								patCitation_as_list := correspondingDocs_child.patCitation as list 
								patCitation_self := list_self(patCitation_as_list)

								fact_obj := fact_get("patentCitations.patCitation.correspondingDocs.patCitation.content",patCitation_self.xml,"7","637","639","","patentCitations.patCitation.correspondingDocs",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

							else if correspondingDocs_child._internal_ = "litCitation" then 
								litCitation_as_list := correspondingDocs_child.litCitation as list 
								litCitation_self := list_self(litCitation_as_list)

								fact_obj := fact_get("patentCitations.patCitation.correspondingDocs.litCitation.content",litCitation_self.xml,"7","637","638","","patentCitations.patCitation.correspondingDocs",[1,1,array_index,1])
								fact_obj.language := none
								fact_obj.input := none
								list_add(output.patent.factValues,fact_obj)

							end if 

						end loop   

					end if 
				
				end loop 
				
			end if 

		array_index := array_index + 1
		end loop 
  	end if

 
end rule
begin rule "classification"
  

  classification_list_sizes := list_new()
  
  max_size := 0
  classification_list := list_new()
  
  if input.patent.classificationCpc then 
    if list_size(input.patent.classificationCpc as list) > max_size then 
      max_size := list_size(input.patent.classificationCpc as list) - 1
      classification_list := input.patent.classificationCpc as list
    end if 
  end if 

  if input.patent.classificationCpcCurrent then 
    if list_size(input.patent.classificationCpcCurrent as list) > max_size then 
      max_size := list_size(input.patent.classificationCpcCurrent as list) - 1
      classification_list := input.patent.classificationCpcCurrent as list
    end if 
  end if 
  
  if input.patent.classificationIpc then 
    if list_size(input.patent.classificationIpc as list) > max_size then 
      max_size := list_size(input.patent.classificationIpc as list)- 1
      classification_list := input.patent.classificationIpc as list
    end if 
  end if 
  
  if input.patent.classificationIpcCurrent then 
    if list_size(input.patent.classificationIpcCurrent as list) > max_size then 
      max_size := list_size(input.patent.classificationIpcCurrent as list) - 1
      classification_list := input.patent.classificationIpcCurrent as list
    end if 
  end if 
  
  
  if input.patent.classificationNational then 
    if list_size(input.patent.classificationNational as list) > max_size then 
      max_size := list_size(input.patent.classificationNational as list) - 1
      classification_list := input.patent.classificationNational as list
    end if 
  end if 
  
  classification_output.patent.relationships := list_new() 

  array_index := 1
  for item in classification_list loop 
  
    relationship_node := {}
    relationship_node.relatedToIdScheme := ""
    relationship_node.updatedBy := ""
    relationship_node.confidence := 100
    relationship_node.queued := ""
    relationship_node.parentArrayIndex := [1, 1]
    relationship_node.predicate := "classification_of"
    relationship_node.sourcePGUID := "urn:source:000000000000000000000000000007"
    relationship_node.groupPGUID := "urn:fact:patent:000000000000000000000000000663"
    relationship_node.wipFlag := false
    relationship_node.relatedToId := ""
    relationship_node.factPGUID := "urn:fact:patent:000000000000000000000000000710"
    relationship_node.action := "add"
    relationship_node.arrayIndex := array_index 
    relationship_node.additionalFacts := list_new()
    
    list_add(classification_output.patent.relationships, relationship_node)
    array_index := array_index + 1 
  end loop 
  

    ######### START FACT: CLASSIFICATIONCPCCURRENT ############################
    if input.patent.classificationCpcCurrent then 
        classificationCpcCurrent := input.patent.classificationCpcCurrent
        items := classificationCpcCurrent as list 
        classificationCpcCurrent_self := list_self(items)
        
        array_index := 1 
        
        for item in items loop
            relationship_node := list_get(classification_output.patent.relationships, array_index - 1)
            add_facts := relationship_node.additionalFacts

            if item.@tsip:actionDate then 
                fact_obj := fact_get("classifications.classification.classificationActionDate",item.@tsip:actionDate,"7","710","669",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 

        
            if item.@tsip:applied then 
                fact_obj := fact_get("classifications.classification.classificationDataSource",item.@tsip:applied,"7","710","670",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.error then 
                fact_obj := fact_get("classifications.classification.classificationError",item.error,"7","710","679",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:status then 
                fact_obj := fact_get("classifications.classification.classificationStatus",item.@tsip:status,"7","710","672",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:level then 
                fact_obj := fact_get("classifications.classification.classificationLevel",item.@tsip:level,"7","710","671",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts, fact_obj)
            end if 
            
        
            if item.linker then 
                fact_obj := fact_get("classifications.classification.classificationLinker",item.linker,"7","710","678",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:office then 
                fact_obj := fact_get("classifications.classification.classificationGeneratingOffice",item.@tsip:office,"7","710","673",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:position then 
                fact_obj := fact_get("classifications.classification.classificationSymbolPosition",item.@tsip:position,"7","710","674",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.rangeFrom then 
                fact_obj := fact_get("classifications.classification.classificationRangeFrom",item.rangeFrom,"7","710","680",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.rangeTo then 
                fact_obj := fact_get("classifications.classification.classificationRangeTo",item.rangeTo,"7","710","681",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:schemeOrigin then 
                fact_obj := fact_get("classifications.classification.classificationSchemeOrigin",item.@tsip:schemeOrigin,"7","710","687",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:scope then 
                fact_obj := fact_get("classifications.classification.classificationScope",item.@tsip:scope,"7","710","676",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.cpc then 
                fact_obj := fact_get("classifications.classification.classificationText",item.cpc,"7","710","667",none,"classifications.classification",[1, 1])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:version then 
                fact_obj := fact_get("classifications.classification.classificationVersionIndicationDate",item.@tsip:version,"7","710","677",none,"classifications.classification",[1, 1, array_index])
                fact_obj.input := "CpcCurrent"            
                list_add(add_facts,fact_obj)
            end if 
            
            
            if array_index = 1 then
                fact_obj := fact_get("classifications.classification.content",classificationCpcCurrent_self.xml,"7","710","666",none,"classifications.classification",[1, 1])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
                
                fact_obj := fact_get("classifications.classification.classificationInstance","CpcCurrent","7","710","664",none,"classifications.classification",[1, 1])
                fact_obj.input := "CpcCurrent"
                list_add(add_facts,fact_obj)
                
                fact_obj := fact_get("classifications.classification.classificationScheme","Cpc","7","710","665",none,"classifications.classification",[1, 1])
                fact_obj.input := "CpcCurrent"                
                list_add(add_facts,fact_obj)

            end if 
            relationship_node.additionalFacts := add_facts
            list_add(classification_output.patent.relationships, relationship_node)
            array_index := array_index + 1
        end loop 
    end if 
    ######### END FACT: CLASSIFICATIONCPCCURRENT ############################
    
    
    ######### START FACT: CLASSIFICATIONIPC ############################
    if input.patent.classificationIpc then 
        classificationIpc := input.patent.classificationIpc
        items := classificationIpc as list 
        classificationIpc_self := list_self(items)

        array_index := 1 
        for item in items loop 
            relationship_node := list_get(classification_output.patent.relationships, array_index - 1)
            add_facts := relationship_node.additionalFacts
            
            
            if item.@tsip:actionDate then 
                fact_obj := fact_get("classifications.classification.classificationActionDate",item.@tsip:actionDate,"7","710","669",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:applied then 
                fact_obj := fact_get("classifications.classification.classificationDataSource",item.@tsip:applied,"7","710","670",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:classLevel then 
                fact_obj := fact_get("classifications.classification.classificationLevel",item.@tsip:classLevel,"7","710","671",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.error then 
                fact_obj := fact_get("classifications.classification.classificationError",item.error,"7","710","679",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:level then 
                fact_obj := fact_get("classifications.classification.classificationStatus",item.@tsip:level,"7","710","672",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.linker then 
                fact_obj := fact_get("classifications.classification.classificationLinker",item.linker,"7","710","678",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:office then 
                fact_obj := fact_get("classifications.classification.classificationGeneratingOffice",item.@tsip:office,"7","710","673",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:position then 
                fact_obj := fact_get("classifications.classification.classificationSymbolPosition",item.@tsip:position,"7","710","674",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:rank then 
                fact_obj := fact_get("classifications.classification.classificationRank",item.@tsip:rank,"7","710","675",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:scope then 
                fact_obj := fact_get("classifications.classification.classificationScope",item.@tsip:scope,"7","710","676",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.ipc then 
                fact_obj := fact_get("classifications.classification.classificationText",item.ipc,"7","710","667",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:type then 
                fact_obj := fact_get("classifications.classification.classificationType",item.@tsip:type,"7","710","668",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:version then 
                fact_obj := fact_get("classifications.classification.classificationVersionIndicationDate",item.@tsip:version,"7","710","677",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
            end if 

            if array_index = 1 then

                fact_obj := fact_get("classifications.classification.content",classificationIpc_self.xml,"7","710","666",none,"classifications.classification",[1, 1])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)    
                

                fact_obj := fact_get("classifications.classification.classificationInstance","Ipc","7","710","664",none,"classifications.classification",[1, 1])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)
                
                
                fact_obj := fact_get("classifications.classification.classificationScheme","Ipc","7","710","665",none,"classifications.classification",[1, 1])
                fact_obj.input := "Ipc"
                list_add(add_facts,fact_obj)        
                
            end if 
            
            array_index := array_index + 1
        end loop 
    end if 
    ######### END FACT: CLASSIFICATIONIPC ############################
    
    ######### START FACT: CLASSIFICATIONIPCCURRENT ############################
    if input.patent.classificationIpcCurrent then 
        classificationIpcCurrent := input.patent.classificationIpcCurrent
        items := classificationIpcCurrent as list 
        classificationIpcCurrent_self := list_self(items)


        array_index := 1 
        for item in items loop 
            relationship_node := list_get(classification_output.patent.relationships, array_index - 1)
            add_facts := relationship_node.additionalFacts
                    
            if item.@tsip:actionDate then 
                fact_obj := fact_get("classifications.classification.classificationActionDate",item.@tsip:actionDate,"7","710","669",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:applied then 
                fact_obj := fact_get("classifications.classification.classificationDataSource",item.@tsip:applied,"7","710","670",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:classLevel then 
                fact_obj := fact_get("classifications.classification.classificationLevel",item.@tsip:classLevel,"7","710","671",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.error then 
                fact_obj := fact_get("classifications.classification.classificationError",item.error,"7","710","679",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:level then 
                fact_obj := fact_get("classifications.classification.classificationStatus",item.@tsip:level,"7","710","672",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.linker then 
                fact_obj := fact_get("classifications.classification.classificationLinker",item.linker,"7","710","678",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:office then 
                fact_obj := fact_get("classifications.classification.classificationGeneratingOffice",item.@tsip:office,"7","710","673",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:position then 
                fact_obj := fact_get("classifications.classification.classificationSymbolPosition",item.@tsip:position,"7","710","674",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:rank then 
                fact_obj := fact_get("classifications.classification.classificationRank",item.@tsip:rank,"7","710","675",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:scope then 
                fact_obj := fact_get("classifications.classification.classificationScope",item.@tsip:scope,"7","710","676",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.ipc then 
                fact_obj := fact_get("classifications.classification.classificationText",item.ipc,"7","710","667",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:type then 
                fact_obj := fact_get("classifications.classification.classificationType",item.@tsip:type,"7","710","668",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
        
            if item.@tsip:version then 
                fact_obj := fact_get("classifications.classification.classificationVersionIndicationDate",item.@tsip:version,"7","710","677",none,"classifications.classification",[1,1,array_index])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 

            if array_index = 1 then
                fact_obj := fact_get("classifications.classification.content",classificationIpcCurrent_self.xml,"7","710","666",none,"classifications.classification",[1,1])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
                
        
                fact_obj := fact_get("classifications.classification.classificationInstance","Ipc","7","710","664",none,"classifications.classification",[1,1])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            
        
                fact_obj := fact_get("classifications.classification.classificationScheme","Ipc","7","710","665",none,"classifications.classification",[1,1])
                fact_obj.input := "IpcCurrent"
                list_add(add_facts,fact_obj)
            end if 
            
            array_index := array_index + 1
        end loop 
    end if 
    ######### END FACT: CLASSIFICATIONIPCCURRENT ############################
    
    
    ######### START FACT: CLASSIFICATIONNATIONAL ############################
    if input.patent.classificationNational then
      items := input.patent.classificationNational as list
      classificationNational_self := list_self(items)

      array_index := 1 
      for item in items loop  
        relationship_node := list_get(classification_output.patent.relationships, array_index - 1)
        add_facts := relationship_node.additionalFacts

        if item._internal_ = "npc" then
          fact_obj := fact_get("classifications.classification.classificationNpc",item.npc,"7","710","684",none,"classifications.classification",[1,1, array_index])
          fact_obj.language := none
          fact_obj.input := "National"
          list_add(add_facts,fact_obj)
        end if
        
        array_index := array_index + 1
      end loop 
  
      if classificationNational_self.@tsip:office then 
        fact_obj := fact_get("classifications.classification.classificationGeneratingOffice",classificationNational_self.@tsip:office,"7","710","664",none,"classifications.classification",[1,1])
        fact_obj.language := none
        fact_obj.input := "National"
        list_add(add_facts,fact_obj)
      end if 
      
      fact_obj := fact_get("classifications.classification.content",classificationNational_self.xml,"7","710","666",none,"classifications.classification",[1,1])
      fact_obj.language := none
      fact_obj.input := "National"
      list_add(add_facts,fact_obj)
    
    end if
    ######### END FACT: CLASSIFICATIONNATIONAL ############################

    # START: adding list of relationship node, that belong to classification only, to the relationship list ######
    for item in classification_output.patent.relationships loop 
        list_add(output.patent.relationships, item)
    end loop 
    # END ###################################################################


end rule
begin rule "agents"

    ######### START FACT: AGENTS ############################
    if input.patent.agents then
      agents := input.patent.agents as list
      agents_self := list_self(agents)
		
      array_index := 1 
      for agnt in agents loop 
        relationship_node := {}
        relationship_node.relatedToIdScheme := ""
        relationship_node.updatedBy := ""
        relationship_node.confidence := 100
        relationship_node.queued := ""
        relationship_node.parentArrayIndex := [1, 1]
        relationship_node.predicate := "agent_of"
        relationship_node.sourcePGUID := "urn:source:000000000000000000000000000007"
        relationship_node.groupPGUID := "urn:fact:patent:000000000000000000000000000220"
        relationship_node.wipFlag := false
        relationship_node.relatedToId := ""
        relationship_node.factPGUID := "urn:fact:patent:000000000000000000000000000221"
        relationship_node.action := "add"
        relationship_node.arrayIndex := array_index 
        add_facts := list_new()
        
        # update
        if agnt.update then 
        end if 
          
        if agnt.@tsip:agentType then 
			    fact_obj := fact_get("agents.agent.type",agnt.@tsip:agentType,"7","221","222",none,"agents.agent",[1,1,array_index])
			    fact_obj.language := none
			    fact_obj.input := none
			    list_add(add_facts, fact_obj)	
		    end if 

      	agnt_elements := agnt.agent as list 
      	
      	for agnt_element in agnt_elements loop
      	
      		# agentTotal
      		if agnt_element._internal_ = "agentTotal" then 
            fact_obj := fact_get("agents.agent.agentTotal.Content",agnt_element.agentTotal,"7","225","226",none,"agents.agent.agentTotal",[1,1,array_index,1])
            fact_obj.language := none
            fact_obj.input := none
            list_add(add_facts, fact_obj)
          end if
      		
      		if agnt_element._internal_ = "name" then 
             if agnt_element.name.nameTotal then  
                fact_obj := fact_get("agents.agent.name.nameTotal.form",agnt_element.name.nameTotal.@tsip:form,"7","231","232",none,"agents.agent.name.nameTotal",[1,1,array_index,1,1])
                fact_obj.language := none
                fact_obj.input := none
                list_add(add_facts, fact_obj)
                
                fact_obj := fact_get("agents.agent.name.nameTotal.text",agnt_element.name.nameTotal,"7","231","725",none,"agents.agent.name.nameTotal",[1,1,array_index,1,1])
                fact_obj.language := none
                fact_obj.input := none
                list_add(add_facts, fact_obj)
            end if
      		end if 
      
      		# address
      		if agnt_element._internal_ = "address" then 
      		end if 
      
      		# agentNumber
      		if agnt_element._internal_ = "agentNumber" then 
      		end if 
      		
      	end loop

        fact_obj := fact_get("agents.agent.content",agents_self.xml,"7","221","248",none,"agents.agent",[1,1,array_index])
        fact_obj.language := none
        fact_obj.input := none
        list_add(add_facts, fact_obj)

		
    		relationship_node.additionalFacts := add_facts
        list_add(output.patent.relationships, relationship_node)
        array_index := array_index + 1
      end loop
      
     
  end if
    ######### END FACT: AGENTS ############################


end rule
begin rule "other nodes"


  output.patent.lineage := ["urn:asset:7:e59c99fd-5916-420a-9a78-3131eeeeabd4"]  
  output.patent.confidence := 80
  output.patent.PGUID := ""
  output.patent.sourcePGUID := "urn:source:000000000000000000000000000007"
	output.patent.dataAsset.assetID :=  "urn:asset:18"
	output.patent.dataAsset.name := "patents"
	output.patent.dataAsset.version := "1.0.0"
  output.patent.itemStatus := "Active"
	output.patent.sourceName := "First Level Data"
	output.patent.usageRights := none
	output.patent.info.timeStamp := now()
  output.patent.info.ID := "urn:uuid:a07c9280-4766-4435-9ced-3d552547be50"
	output.patent.info.version := "1.0.0"
	
	
	######### START FACT: PATENTS ############################
    
        if input.patent.@tsip:action then 
            fact_obj := fact_get("action",input.patent.@tsip:action,"7","","733",none,"patent",[1])
            fact_obj.groupPGUID := none
            fact_obj.language := none
            fact_obj.input := none
            list_add(output.patent.factValues,fact_obj)
        end if 
        

        if input.patent.@tsip:cc then 
            fact_obj := fact_get("countryCode",input.patent.@tsip:cc,"7","","1",none,"patent",[1])
            fact_obj.groupPGUID := none
            fact_obj.language := none
            fact_obj.input := none
            list_add(output.patent.factValues,fact_obj)
            

            country_code := input.patent.@tsip:cc
          
            output.patent.provenance := ""
            
            if toLower(country_code) = "us" then 
              output.patent.provenance := "USPTO"
              
            else if toLower(country_code) = "gb" then 
              output.patent.provenance := "UKPTO"
            
            else if toLower(country_code) = "cn" then 
              output.patent.provenance := "CNIPPH"
            
            else 
              output.patent.provenance := ""
            
            end if  
                  
        end if 
        

        if input.patent.@tsip:ki then 
            fact_obj := fact_get("kindCode",input.patent.@tsip:ki,"7","","2",none,"patent",[1])
            fact_obj.groupPGUID := none
            fact_obj.language := none
            fact_obj.input := none
            list_add(output.patent.factValues,fact_obj)
        end if 
        

        if input.patent.@tsip:se then 
            fact_obj := fact_get("documentNumber",input.patent.@tsip:se,"7","","3",none,"patent",[1])
            fact_obj.groupPGUID := none
            fact_obj.language := none
            fact_obj.input := none
            list_add(output.patent.factValues,fact_obj)
        end if 
    
	######### END LOGICAL UNIT: PATENTS ############################


end rule
begin rule "metaData"


  ######### START FACT: METADATA ############################
    if input.patent.metaData then
        metaData := input.patent.metaData as list 
        metaData_self := list_self(metaData)

        list_add(output.patent.factValues,fact_get("metadata.content", metaData_self.xml,"7","83","84",none,"metadata",[1, 1]))
    end if 
  ######### END FACT: METADATA ############################


end rule
begin rule "examiners"


	######### START FACT: EXAMINERS ############################
	if input.patent.examiners then 
		examiners := input.patent.examiners as list
		examiners_self := list_self(examiners)

		array_index := 1 
		for exam in examiners loop 
			relationship_node := {}
      relationship_node.relatedToIdScheme := ""
      relationship_node.updatedBy := ""
      relationship_node.confidence := 100
      relationship_node.queued := ""
      relationship_node.parentArrayIndex := [1, 1]
      relationship_node.predicate := "examiner_of"
      relationship_node.sourcePGUID := "urn:source:000000000000000000000000000007"
      relationship_node.groupPGUID := "urn:fact:patent:000000000000000000000000000375"
      relationship_node.wipFlag := false
      relationship_node.relatedToId := ""
      relationship_node.factPGUID := "urn:fact:patent:000000000000000000000000000376"
      relationship_node.action := "add"
      relationship_node.arrayIndex := array_index 
      add_facts := list_new()

      
      # examiner attributes
      if exam.@tsip:no then 
				fact_obj := fact_get("examiners.examiner.no",exam.@tsip:no,"7","376","379","","examiners.examiner",[1,1,array_index])
				fact_obj.language := none
				fact_obj.input := none
				list_add(add_facts,fact_obj)
			end if 
			
			if exam.@tsip:type then 
				fact_obj := fact_get("examiners.examiner.type",exam.@tsip:type,"7","376","377","","examiners.examiner",[1,1,array_index])
				fact_obj.language := none
				fact_obj.input := none
				list_add(add_facts,fact_obj)
			end if 

      exam_elements := exam.examiner as list 
	
    	for exam_element in exam_elements loop
    	  
  	    # examinerTotal
    		if exam_element._internal_ = "examinerTotal" then 
    			if exam_element.examinerTotal.@tsip:form then 
    				fact_obj := fact_get("examiners.examiner.examinerTotal.form",exam_element.examinerTotal.@tsip:form,"7","380","382","","examiners.examiner.examinerTotal",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
    			if exam_element.examinerTotal.refId then 
    				fact_obj := fact_get("examiners.examiner.examinerTotal.refId",exam_element.examinerTotal.refId,"7","380","383","","examiners.examiner.examinerTotal",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
    
    			if exam_element.examinerTotal then 
    				fact_obj := fact_get("examiners.examiner.examinerTotal.content",exam_element.examinerTotal,"7","380","381","","examiners.examiner.examinerTotal",[1,1,array_index])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    		end if 
    
    		# name
    		if exam_element._internal_ = "name" then 
    			if exam_element.name.forenames then 
    				fact_obj := fact_get("examiners.examiner.name.foreNames",exam_element.name.forenames,"7","384","385","","examiners.examiner.name",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
    
    			if exam_element.name.nameTotal.@tsip:form then 
    				fact_obj := fact_get("examiners.examiner.name.nameTotal.form",exam_element.name.nameTotal.@tsip:form,"7","386","388","","examiners.examiner.name.nameTotal",[1,1,array_index,1,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 

    			if exam_element.name.nameTotal.refId then 
    				fact_obj := fact_get("examiners.examiner.name.nameTotal.refId",exam_element.name.nameTotal.refId,"7","386","389","","examiners.examiner.name.nameTotal",[1,1,array_index,1,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 

    			if exam_element.name.nameTotal then 
    				fact_obj := fact_get("examiners.examiner.name.nameTotal.text",exam_element.name.nameTotal,"7","386","726","","examiners.examiner.name.nameTotal",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 

    			if exam_element.name.surname then 
    				fact_obj := fact_get("examiners.examiner.name.surName",exam_element.name.surname,"7","384","387","","examiners.examiner.name",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    		end if 
    
        # address
    		if exam_element._internal_ = "address" then 
    			if exam_element.address.addressLine.@tsip:no then 
    				fact_obj := fact_get("examiners.examiner.address.addressLine.no",exam_element.address.addressLine.@tsip:no,"7","396","398","","examiners.examiner.address.addressLine",[1,1,array_index,1,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
      		if exam_element.address.addressLine then 
    				fact_obj := fact_get("examiners.examiner.address.addressLine.content",exam_element.address.addressLine,"7","396","397","","examiners.examiner.address.addressLine",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
    			if exam_element.address.addressTotal then 
    				fact_obj := fact_get("examiners.examiner.address.addressTotal",exam_element.address.addressTotal,"7","390","391","","examiners.examiner.address",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
    			if exam_element.address.city then 
    				fact_obj := fact_get("examiners.examiner.address.city",exam_element.address.city,"7","390","392","","examiners.examiner.address",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
    
    			if exam_element.address.countryCode then 
    				fact_obj := fact_get("examiners.examiner.address.countryCode",exam_element.address.countryCode,"7","390","393","","examiners.examiner.address",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			
    
    			if exam_element.address.postalCode then 
    				fact_obj := fact_get("examiners.examiner.address.postalCode",exam_element.address.postalCode,"7","390","395","","examiners.examiner.address",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    			

    			if exam_element.address.state then 
    				fact_obj := fact_get("examiners.examiner.address.state",exam_element.address.state,"7","390","394","","examiners.examiner.address",[1,1,array_index,1])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    		end if 
    		
    		# unit
    		if exam_element._internal_ = "unit" then 
    			if item.unit then 
    				fact_obj := fact_get("examiners.examiner.unit",exam_element.unit,"7","376","399","","examiners.examiner",[1,1,array_index])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    		end if 
    		
    		# examinerNumber
    		if exam_element._internal_ = "examinerNumber" then 
    			if exam_element.examinerNumber then 
    				fact_obj := fact_get("examiners.examiner.examinerNumber",exam_element.examinerNumber,"7","376","400","","examiners.examiner",[1,1,array_index])
    				fact_obj.language := none
    				fact_obj.input := none
    				list_add(add_facts,fact_obj)
    			end if 
    		end if 
    	end loop

			# refId does not exist in DTD
			if item.refId then 
				fact_obj := fact_get("examiners.examiner.refId",item.refId,"7","376","378","","examiners.examiner",[1,1,array_index])
				fact_obj.language := none
				fact_obj.input := none
				list_add(add_facts,fact_obj)
			end if 

			if array_index = 1 then 
				fact_obj := fact_get("examiners.examiner.content",examiners_self.xml ,"7","376","401","","examiners.examiner",[1,1, array_index])
				fact_obj.language := none
				fact_obj.input := none
				list_add(add_facts,fact_obj)
			end if 
			
			array_index := array_index + 1

			relationship_node.additionalFacts := add_facts
			#list_add(relationships, "relationship_node")
			list_add(output.patent.relationships, relationship_node)
		end loop 

		

	end if 
	######### END FACT: EXAMINERS ############################


end rule
begin rule "inventors3"

    ######### START FACT: INVENTORS ############################
    if input.patent.inventors then 
        inventors := input.patent.inventors as list
        relationships := list_new()
        
        array_index := 1 
        for inv in inventors loop
            relationship_node := {}
            relationship_node.relatedToIdScheme := ""
            relationship_node.updatedBy := ""
            relationship_node.confidence := 100
            relationship_node.queued := ""
            relationship_node.parentArrayIndex := [1, 1]
            relationship_node.predicate := "inventor_of"
            relationship_node.sourcePGUID := "urn:source:000000000000000000000000000007"
            relationship_node.groupPGUID := "urn:fact:patent:000000000000000000000000000344"
            relationship_node.wipFlag := false
            relationship_node.relatedToId := ""
            relationship_node.factPGUID := "urn:fact:patent:000000000000000000000000000345"
            relationship_node.action := "add"
            relationship_node.arrayIndex := array_index 
            add_facts := list_new()
            
            if inv.@tsip:no then 
                list_add(add_facts,fact_get("inventors.inventor.no",inv.@tsip:no,"7","345","347",none,"inventors.inventor",[1, 1, array_index, 1]))
            end if 
            
            # refId???
            if inv.refId then 
                list_add(add_facts,fact_get("inventors.inventor.refId",inv.refId,"7","345","346",none,"inventors.inventor",[1, 1, array_index, 1]))
            end if 
          	
          	inv_elements := inv.inventor as list 

          	for inv_element in inv_elements loop
          	
          		# inventorTotal
          		if inv_element._internal_ = "inventorTotal" then 
                list_add(add_facts,fact_get("inventors.inventor.inventorTotal.content",inv_element.inventorTotal,"7","357","358",none,"inventors.inventor.inventorTotal",[1, 1, array_index, 1]))

                if inv_element.inventorTotal.@tsip:form then 
                    list_add(add_facts,fact_get("inventors.inventor.inventorTotal.form",inv_element.inventorTotal.@tsip:form,"7","357","359",none,"inventors.inventor.inventorTotal",[1, 1, array_index, 1]))
                end if 
          
                if inv_element.inventorTotal.refId then 
                    list_add(add_facts,fact_get("inventors.inventor.inventorTotal.refId",inv_element.inventorTotal.refId,"7","357","360",none,"inventors.inventor.inventorTotal",[1, 1, array_index, 1]))
                end if 
          		end if 
              
              # name
          		if inv_element._internal_ = "name" then 
          		  name_elements := inv_element.name as list
          		  
          		  for name_element in name_elements loop
          		  
                  # forenames
                  if name_element._internal_ = "forenames" then 
                    list_add(add_facts,fact_get("inventors.inventor.name.forenames",name_element.name.forenames,"7","364","365",none,"inventors.inventor.name",[1, 1, array_index, 1]))
                  end if 
                  
                  # nameTotal
                  if name_element._internal_ = "nameTotal" then
                    if inv_element.nameTotal.@tsip:form then 
                        list_add(add_facts,fact_get("inventors.inventor.name.nameTotal.form",name_element.name.nameTotal.@tsip:form,"7","366","368",none,"inventors.inventor.name.nameTotal",[1, 1, array_index, 1, 1]))
                    end if 
                    
                
                    if name_element.nameTotal.refId then 
                        list_add(add_facts,fact_get("inventors.inventor.name.nameTotal.refId",name_element.name.nameTotal.refId,"7","366","370",none,"inventors.inventor.name.nameTotal",[1, 1, array_index, 1, 1]))
                    end if 
                    
                
                    if name_element.nameTotal.@tsip:src then 
                        list_add(add_facts,fact_get("inventors.inventor.name.nameTotal.src",name_element.name.nameTotal.@tsip:src,"7","366","369",none,"inventors.inventor.name.nameTotal",[1, 1, array_index, 1, 1]))
                    end if 
                    
                
                    if name_element.nameTotal then 
                        list_add(add_facts,fact_get("inventors.inventor.name.nameTotal.content",name_element.name.nameTotal,"7","366","367",none,"inventors.inventor.name.nameTotal",[1, 1, array_index, 1]))
                    end if 
                  end if 
                  
                  # surname              
                  if name_element._internal_ = surname then 
                    list_add(add_facts,fact_get("inventors.inventor.name.surname",name_element.name.surname,"7","364","371",none,"inventors.inventor.name",[1, 1, array_index, 1]))
                  end if 
          	    end loop
        	    end if 
          	
          
          		# address
          		if inv_element._internal_ = "address" then 
                if inv_element.address.addressLine.@tsip:no then 
                    list_add(add_facts,fact_get("inventors.inventor.address.addressLine.no",inv_element.address.addressLine.@tsip:no,"7","350","351",none,"inventors.inventor.address.addressLine",[1, 1, array_index, 1, 1]))
                end if 
                
            
                if inv_element.address.addressLine then 
                    list_add(add_facts,fact_get("inventors.inventor.address.addressLine.content",inv_element.address.addressLine,"7","350","352",none,"inventors.inventor.address.addressLine",[1, 1, array_index, 1]))
                end if 
                
            
                if inv_element.address.addressTotal then 
                    list_add(add_facts,fact_get("inventors.inventor.address.addressTotal",inv_element.address.addressTotal,"7","348","349",none,"inventors.inventor.address",[1, 1, array_index, 1]))
                end if 
                
            
                if inv_element.address.city then 
                    list_add(add_facts,fact_get("inventors.inventor.address.city",inv_element.address.city,"7","348","353",none,"inventors.inventor.address",[1, 1, array_index, 1]))
                end if 
                
            
                if inv_element.address.countryCode then 
                    list_add(add_facts,fact_get("inventors.inventor.address.countryCode",inv_element.address.countryCode,"7","348","354",none,"inventors.inventor.address",[1, 1, array_index, 1]))
                end if 
                
            
                if exam_element.address.postalCode then 
                    list_add(add_facts,fact_get("inventors.inventor.address.postalCode",exam_element.address.postalCode,"7","348","356",none,"inventors.inventor.address",[1, 1, array_index, 1]))
                end if 
                
            
                if inv_element.address.state then 
                    list_add(add_facts,fact_get("inventors.inventor.address.state",inv_element.address.state,"7","348","355",none,"inventors.inventor.address",[1, 1, array_index, 1]))
                end if 
          		
          		end if 
            
              # limitation
          		if inv_element._internal_ = "limitation" then 
                list_add(add_facts,fact_get("inventors.inventor.limitation.content",inv_element.limitation,"7","361","362",none,"inventors.inventor.limitation",[1, 1, array_index, 1]))

                if inv_element.limitation.@tsip:type then 
                    list_add(add_facts,fact_get("inventors.inventor.limitation.type",inv_element.limitation.@tsip:type,"7","361","363",none,"inventors.inventor.limitation",[1, 1, array_index, 1]))
                end if 
          		end if 
          		
          		# residence
          		if inv_element._internal_ = "residence" then 
                list_add(add_facts,fact_get("inventors.inventor.residence",inv_element.residence,"7","345","373",none,"inventors.inventor",[1, 1, array_index, 1]))
          		end if 
          		
          		# nationality
          		if inv_element._internal_ = "nationality" then 
                list_add(add_facts,fact_get("inventors.inventor.nationality",inv_element.nationality,"7","345","372",none,"inventors.inventor",[1, 1, array_index, 1]))
          		end if 
          
          	end loop

            if array_index = 1 then 
                items2 := inventors as list 
                xmlString := "<inventors  tsip:action='new'>"
                for item2 in items2 loop
                    xmlString := concat([xmlString, item2.xml])
                end loop 
                xmlString := concat([xmlString, "</inventors>"])
                list_add(add_facts,fact_get("inventors.inventor.content",xmlString,"7","345","374",none,"inventors.inventor",[1, 1]))
            end if 

            relationship_node.additionalFacts := add_facts
            list_add(relationships, relationship_node)
            
            array_index := array_index + 1
        end loop 
        
        output.patent.relationships := relationships
    end if 
    ######### END FACT: INVENTORS ############################



end rule
